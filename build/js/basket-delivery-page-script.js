"use strict";function _objectWithoutProperties(e,t){if(null==e)return{};var r,n,a=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],!(0<=t.indexOf(r))&&Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}function _extends(){return(_extends=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,r,n,a,i,o){try{var c=e[i](o),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){function i(e){asyncGeneratorStep(c,n,a,i,o,"next",e)}function o(e){asyncGeneratorStep(c,n,a,i,o,"throw",e)}var c=e.apply(t,r);i(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null==arguments[t]?{}:arguments[t],n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){_defineProperty(e,t,r[t])})}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}}window.citiesList=[{name:"Абакан",kladr_id:"19000001000",firstLetter:"А",price:"450"},{name:"Альметьевск",kladr_id:"16008001000",price:"450"},{name:"Анадырь",kladr_id:"87000001000",price:"450"},{name:"Архангельск",kladr_id:"29000001000",price:"450"},{name:"Астрахань",kladr_id:"30000001000",price:"450"},{name:"Барнаул",kladr_id:"22000001000",firstLetter:"Б",price:"450"},{name:"Белгород",kladr_id:"31000001000",price:"450"},{name:"Биробиджан",kladr_id:"79000001000",price:"450"},{name:"Благовещенск",kladr_id:"28000001000",price:"450"},{name:"Братск",kladr_id:"38000005000",price:"450"},{name:"Брянск",kladr_id:"32000001000",price:"450"},{name:"Бугульма",kladr_id:"16014001000",price:"450"},{name:"Бузулук",kladr_id:"56000006000",branches:[{name:"Бузулук, ул. Дорожная, 35",street:"ул. Дорожная, 35",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"28"}],mapLink:"https://yandex.ru/map-widget/v1/?um=constructor%3A9a0521a20ec9ea1315277cdb881c07a8ac38e1dbe49164611a0d8cca3276111f&amp;source=constructor"},{name:"Великий Новгород",kladr_id:"53000001000",firstLetter:"В",price:"450"},{name:"Владивосток",kladr_id:"25000001000",price:"450"},{name:"Владикавказ",kladr_id:"15000001000",price:"450"},{name:"Владимир",kladr_id:"33000001000",price:"450"},{name:"Волгоград",kladr_id:"34000001000",price:"450"},{name:"Волгодонск",kladr_id:"61000004000",price:"450"},{name:"Вологда",kladr_id:"35000001000",price:"450"},{name:"Воронеж",kladr_id:"36000001000",price:"450"},{name:"Горно-Алтайск",kladr_id:"04000001000",firstLetter:"Г",price:"450"},{name:"Грозный",kladr_id:"20000001000",price:"450"},{name:"Дзержинск",kladr_id:"52000002000",firstLetter:"Д",price:"450"},{name:"Дятьково",kladr_id:"32006001000",price:"450"},{name:"Екатеринбург",kladr_id:"66000001000",branches:[{name:"Екатеринбург, Железнодорожный район (Старая сортировка), ул.Билимбаевская, д.4",street:"Железнодорожный район (Старая сортировка), ул.Билимбаевская, д.4",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"37"}],mapLink:"https://yandex.ru/map-widget/v1/?um=constructor%3A35a1946a7b5be2a472fcbf066fd1289306b9a854cf69f165806d9d034c79f1ee&amp;source=constructor",firstLetter:"Е"},{name:"Елабуга",kladr_id:"16019001000",price:"450"},{name:"Златоуст",kladr_id:"74000004000",firstLetter:"З",price:"450"},{name:"Иваново",kladr_id:"37000001000",firstLetter:"И",price:"450"},{name:"Ижевск",kladr_id:"18000001000",price:"450"},{name:"Иркутск",kladr_id:"38000003000",price:"450"},{name:"Йошкар-Ола",kladr_id:"12000001000",firstLetter:"Й",price:"450"},{name:"Казань",kladr_id:"16000001000",firstLetter:"К",price:"450"},{name:"Калининград",kladr_id:"39000001000",price:"450"},{name:"Калуга",kladr_id:"40000001000",price:"450"},{name:"Кемерово",kladr_id:"42000009000",price:"450"},{name:"Киров",kladr_id:"43000004000",price:"450"},{name:"Кострома",kladr_id:"44000003000",price:"450"},{name:"Краснодар",kladr_id:"23000001000",price:"450"},{name:"Красноярск",kladr_id:"24000001000",price:"450"},{name:"Курган",kladr_id:"45000001000",price:"450"},{name:"Курск",kladr_id:"46000001000",price:"450"},{name:"Кызыл",kladr_id:"17000001000",price:"450"},{name:"Липецк",kladr_id:"48000001000",firstLetter:"Л",price:"450"},{name:"Магадан",kladr_id:"49000001000",firstLetter:"М",price:"450"},{name:"Магас",kladr_id:"06000001000",price:"450"},{name:"Магнитогорск",kladr_id:"74000009000",price:"450"},{name:"Майкоп",kladr_id:"01000001000",price:"450"},{name:"Мамадыш",kladr_id:"16021000057",price:"450"},{name:"Махачкала",kladr_id:"05000001000",price:"450"},{name:"Москва",kladr_id:"77000000000",price:"450"},{name:"Мурманск",kladr_id:"51000001000",price:"450"},{name:"Набережные Челны",kladr_id:"16000002000",firstLetter:"Н",price:"450"},{name:"Нальчик",kladr_id:"07000001000",price:"450"},{name:"Нарьян-Мар",kladr_id:"83000001000",price:"450"},{name:"Нижний Новгород",kladr_id:"52000001000",price:"450"},{name:"Новокузнецк",kladr_id:"42000012000",price:"450"},{name:"Новосибирск",kladr_id:"54000001000",price:"450"},{name:"Омск",kladr_id:"55000001000",firstLetter:"О",price:"450"},{name:"Оренбург",kladr_id:"56000001000",price:"450"},{name:"Орёл",kladr_id:"57000001000",price:"450"},{name:"Пенза",kladr_id:"58000001000",firstLetter:"П",price:"450"},{name:"Пермь",kladr_id:"59000001000",price:"450"},{name:"Петрозаводск",kladr_id:"10000001000",price:"450"},{name:"Петропавловск-Камчатский",kladr_id:"41000001000",price:"450"},{name:"Псков",kladr_id:"60000001000",price:"450"},{name:"Раменское",kladr_id:"24032000028",firstLetter:"Р",price:"450"},{name:"Ростов-на-Дону",kladr_id:"61000001000",price:"450"},{name:"Рязань",kladr_id:"62000001000",price:"450"},{name:"Салехард",kladr_id:"89000001000",firstLetter:"С",price:"450"},{name:"Самара",kladr_id:"63000001000",price:"450"},{name:"Санкт-Петербург",kladr_id:"78000000000",price:"450"},{name:"Саранск",kladr_id:"13000001000",price:"450"},{name:"Саратов",kladr_id:"64000001000",price:"450"},{name:"Сафоново",kladr_id:"44024000153",price:"450"},{name:"Симферополь",kladr_id:"91000007000",price:"450"},{name:"Смоленск",kladr_id:"67000003000",price:"450"},{name:"Ставрополь",kladr_id:"26000001000",price:"450"},{name:"Сыктывкар",kladr_id:"11000001000",price:"450"},{name:"Таганрог",kladr_id:"61000011000",firstLetter:"Т",price:"450"},{name:"Тамбов",kladr_id:"68000004000",price:"450"},{name:"Тверь",kladr_id:"69000001000",price:"450"},{name:"Томск",kladr_id:"70000001000",price:"450"},{name:"Тула",kladr_id:"71000001000",price:"450"},{name:"Тюмень",kladr_id:"72000001000",price:"450"},{name:"Улан-Удэ",kladr_id:"03000001000",firstLetter:"У",price:"450"},{name:"Ульяновск",kladr_id:"73000001000",price:"450"},{name:"Уфа",kladr_id:"02000001000",price:"450"},{name:"Фряново",kladr_id:"50040000098",firstLetter:"Ф",price:"450"},{name:"Хабаровск",kladr_id:"27000001000",firstLetter:"Х",price:"450"},{name:"Ханты-Мансийск",kladr_id:"86000001000",price:"450"},{name:"Чебоксары",kladr_id:"21000001000",firstLetter:"Ч",price:"450"},{name:"Челябинск",kladr_id:"74000001000",price:"450"},{name:"Черкесск",kladr_id:"09000001000",price:"450"},{name:"Чехов",kladr_id:"50000053000",price:"450"},{name:"Чита",kladr_id:"75000001000",price:"450"},{name:"Шебекино",kladr_id:"31000003000",firstLetter:"Ш",price:"450"},{name:"Щелково",kladr_id:"69015000184",firstLetter:"Щ",price:"450"},{name:"Элиста",kladr_id:"08000001000",firstLetter:"Э",price:"450"},{name:"Южно-Сахалинск",kladr_id:"65000001000",firstLetter:"Ю",price:"450"},{name:"Якутск",kladr_id:"14000001000",firstLetter:"Я",price:"450"},{name:"Ярославль",kladr_id:"76000001000",branches:[{name:"Ярославль, ул. Полушкина роща 16Л",street:"ул. Полушкина роща 16Л",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"28"},{name:"Ярославль, ул. Урицкого 47а",street:"ул. Урицкого 47а",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"41"}],mapLink:"https://yandex.ru/map-widget/v1/?um=constructor%3Aacbcb9cd59b569b50fcb7ed84cbe0a579a8f551b4d992fbdb6781efd00c0c49e&amp;source=constructor"},{name:"Ярцево",kladr_id:"67025000116",price:"450"}],window.h={saveAllCookie:function(e){var t=e.type,r=e.address,n=e.id,a=e.deadline,i=e.cost,o=e.city,c=["deliveryType","deliveryAddress","selfExportPointId","deliveryDeadline","deliveryCost","deliveryCity","deliveryCourier"];[t,r,n,a,i,void 0===o?"":o,e.courier].forEach(function(e,t){return null===e?void saveCookie(c[t],""):void(!e||saveCookie(c[t],e))})},checkAvailable:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return e||t},getText:function(e){return e?e.textContent:""},handleClass:function(e,t,r){return e.classList[t](r)},addClass:function(e,t){return h.handleClass(e,"add",t)},removeClass:function(e,t){return h.handleClass(e,"remove",t)},hasClass:function(e,t){return e.classList.contains(t)},escapeHtml:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})},activateButton:function(e,t){e.disabled=!1,h.handleClass(e,"remove",t)},disableButton:function(e,t){e.disabled=!0,h.handleClass(e,"add",t)},setDataSet:function(e,t,r){return e.dataset[t]=r},getDataSet:function(e,t){return e?e.dataset[t]:""},clearEl:function(e){return e.innerHTML=""},clearInput:function(e){return e.value=""},removeElement:function(e){return null},hide:function(e){return h.handleClass(e,"add","hidden")},show:function(e){return h.handleClass(e,"remove","hidden")},hideAll:function(e){return _toConsumableArray(e).forEach(h.hide)},showAll:function(e){return _toConsumableArray(e).forEach(h.show)},setText:function(e,t){return e.textContent=t},eventAdd:function(e,t,r){return e.addEventListener(t,r)},eventRemove:function(e,t,r){return e.removeEventListener(t,r)},isMatch:function(e,t){return e===t},removeListOfEvents:function(e,t){e.filter(function(e){return e[t]}).forEach(function(e){return h.eventRemove(e.element,e.ev,e.listener)})},addListOfEvents:function(e,t){e.filter(function(e){return e[t]}).forEach(function(e){return h.eventAdd(e.element,e.ev,e.listener)})},setWaitScreen:function(e){return h.show(e)},disableWaitScreen:function(e){return h.hide(e)},lowerCase:function(e){return e.toLowerCase()},checkSubString:function(e,t){return e=h.lowerCase(e),t=h.lowerCase(t),!!~e.indexOf(t)},showError:function(e){return h.show(e)},hideError:function(e){return h.hide(e)},clearStorage:function(e){return e.forEach(function(e){return localStorage.setItem(e,"")})}};var options={basketForm:document.querySelector(".basket-index-page"),waitScreen:document.querySelector(".basket__wait-screen"),reactWrapper:document.querySelector(".basket__stages")},props=_objectSpread({},options,{nextButton:options.basketForm.querySelector(".basket__react-bottom-nav-btn"),progressHeaderButtons:options.basketForm.querySelectorAll(".basket__progress-header-item"),countInputs:options.basketForm.querySelectorAll("input.center")}),basketHandler=function(e){var t={onNextButtonClick:function(){},onProgressHeaderButtonClick:function(){},onCountInputBlur:function(){}},r=function(){return r.initiate=function(){return r},r.handleEventListeners=function(e){var n=e.nextButton,a=e.basketForm,i=e.waitScreen,o=e.reactWrapper,c=e.progressHeaderButtons,l=function(){return l.createEventListeners=function(){return t.onNextButtonClick=function(){var e=function(){var e=function(){return e};return e.prototype={_then:function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},r=arguments.length,n=Array(1<r?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return t.apply(void 0,n),e.prototype},hasBasketSelectedItems:function(){return!!basketApi.getTotalSum()},preventDefault:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{preventDefault:function(){}}).preventDefault()},checkStatement:function(e){var t=e.condition,r=e.stateA,n=e.stateB;return t?r():n()},setWaitScreen:function(e){return h.setWaitScreen(e)},emptyFunction:function(){},showReact:function(){h.show(o),e.hideBasket(),e.renderedBasket=!1},showBasket:function(){e.hideReact(),h.show(a),e.renderedBasket=!0},hideReact:function(){return h.hide(o)},hideBasket:function(){return h.hide(a)},disableWaitScreen:function(){return h.hide(i)},alertMessage:function(e){return alert(e)},showAlertPosition:function(){return e.alertMessage(e.alertPositionMessage)}},Object.setPrototypeOf(e,e.prototype),Object.assign(e,{renderedBasket:!0,alertPositionMessage:"Пожалуйста, выберите хотя бы одну позицию"})}();return function(t){var r=e.preventDefault,n=e.checkStatement,a=e.setWaitScreen,o=e.showReact,c=e.showBasket,l=e.disableWaitScreen,s=e.renderedBasket,u=e.hasBasketSelectedItems,d=e.showAlertPosition;r(t),u()?e._then(a,i)._then(n,{condition:s,stateA:o,stateB:c})._then(l):d()}},t.onCountInputBlur=function(){return a.submit()},l},l.addListeners=function(){return h.eventAdd(n,"click",t.onNextButtonClick()),_toConsumableArray(c).forEach(function(e){return h.eventAdd(e,"click",t.onProgressHeaderButtonClick)}),l},l};return l().createEventListeners().addListeners(),r},r};r().initiate(e).handleEventListeners(e)};basketHandler(props),window.basketApi={getTotalPricesAndItems:function(){return options.basketForm.querySelector(".basket__react-bottom-info").textContent.trim().replace(/\n/gi,"").split(" ").filter(function(e){return!!e.trim()}).filter(function(e){if(!["Оформить","Удалить","выбранные","позиции","Next"].includes(e))return e}).join(" ")},getTotalSum:function(){return window.calculateTotalSum()+(+getCookie("deliveryCost")||0)},getMaxDeliveryDate:function(){var e=function(){var t,r,n=Math.max;return e.getDates=function(r){return t=_toConsumableArray(r.querySelectorAll("tbody tr")).filter(function(e){return e.querySelector("td:nth-of-type(1) input:checked")}).map(function(e){return e.querySelector("td:nth-of-type(6)").textContent}),e},e.handle=function(){return r=(r=t.map(function(e){if(function(e){return!!~e.search(/час/)}(e))return 1;if(function(e){return!!~e.search(/-/)}(e)){var t=e.split("-").map(function(e){return parseInt(e)});return n.apply(Math,_toConsumableArray(t))}return parseInt(e)})).filter(function(e){return isFinite(e)}),_.isEmpty(r)&&(r[0]=0),e},e.calculateMax=function(){return n.apply(Math,_toConsumableArray(r))+ +getCookie("deliveryDeadline")},e};return e().getDates(options.basketForm).handle().calculateMax()},returnToBasket:function(){return props.nextButton.click()},getBasketItems:function(){var e=_toConsumableArray(options.basketForm.querySelectorAll("table tbody tr")).filter(function(e){return!0===e.querySelector("input.active-price-item").checked});try{var t=[];return e.forEach(function(e){var r=_slicedToArray(e.children,6),n=r[0].firstElementChild.dataset,a=n.basketCost,i=n.basketQnt,o=r[1].firstElementChild.firstElementChild,c=o.href,l=o.textContent,s=r[2].firstChild.textContent,u=r[5].textContent;t.push({name:l.trim()+" "+s.trim(),date:u.trim(),count:+i.trim(),price:+a.trim(),link:c})}),t}catch(e){return e.message,[]}},getPositionsNumber:function(){return _toConsumableArray(options.basketForm.querySelectorAll("table tbody tr")).filter(function(e){return!0===e.querySelector("input.active-price-item").checked}).length},getDeliveryPrice:function(){var e=getCookie("deliveryCost");return e||"0"===e?+e:""},getItemsPrice:function(){return window.calculateTotalSum()},getDeliveryDeadline:function(){return+getCookie("deliveryDeadline")},getDeliveryItemDeadline:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.basketApi.getDeliveryDeadline();return e=(e=function(e){return function(e){return!!~e.search(/час/)}(e)?[1]:function(e){return!!~e.search(/-/)}(e)?e.split("-").map(function(e){return parseInt(e)}):[parseInt(e)]}(t)).filter(function(e){return isFinite(e)}),_.isEmpty(e)&&(e[0]=0),e.map(function(e){return e+(r||0)})}};var prevBasketPage=sessionStorage.getItem("prevBasketPage");prevBasketPage&&props.nextButton.click();var ShiptorPointsGetter=function e(t){var r=this,n=t.usersCity,a=t.fromCity;_classCallCheck(this,e),_defineProperty(this,"_escapeHtml",function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}),_defineProperty(this,"_getData",function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.shiptor.ru/public/v1",{method:"POST",headers:{"Content-Type":"application/json"},body:t}).then(function(e){return e.json()});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()),_defineProperty(this,"getDeliveryPoints",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n,a,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<i.length&&void 0!==i[0]?i[0]:{},(n=t.courier)&&(n={courier:n}),a=r._dataHandler({method:"getDeliveryPoints",params:_objectSpread({kladr_id:"".concat(r.usersCityKladr),cod:"0"},n)}),e.next=5,r._getData(a);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)}))),_defineProperty(this,"getUsersCityKladr",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r._dataHandler({method:"suggestSettlement",params:{query:r.usersCity,country_code:"RU"}}),e.next=3,r._getData(t);case 3:n=e.sent;try{r.usersCityKladr=n.result[0].kladr_id}catch(e){r.usersCityKladr="00000000000"}return e.abrupt("return",n);case 6:case"end":return e.stop()}},e)}))),_defineProperty(this,"calculateShipping",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r._dataHandler({method:"calculateShipping",params:{kladr_id:"".concat(r.usersCityKladr),kladr_id_from:"76000001000",cod:"0",length:10,width:10,height:10,weight:1,declared_cost:0}}),e.next=3,r._getData(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))),_defineProperty(this,"_dataHandler",function(e){var t=_.clone(r.cityData);return JSON.stringify(_.extend(t,e))}),this.usersCity=this._escapeHtml(n),this.fromCity=a,this.cityData={id:"JsonRpcClient.js",jsonrpc:"2.0",method:""}};window.deliveryPickup=function(){var e=function(){var e=getCookie("deliveryCity")||YMaps.location.city,t=window.citiesList.filter(function(t){return t.branches&&t.name===e}).flatMap(function(e){e.name;return e.branches}).flatMap(function(e){var t=e.name,r=_slicedToArray(t.split(", "),1)[0],n=t.split(", ");return n.shift(),[[r,n.join(", ")]]});return{city:_.isEmpty(t)?"К сожалению, в данном городе у нас нет филиалов :(":t.map(function(e){return e[0]}),address:_.isEmpty(t)?'Выберите Пункт доставки в разделе "Доставка"':t.map(function(e){return e[1]})}}(),t={pickupModule:document.querySelector(".delivery-pickup")};!function(e){var t=function(e){localStorage.setItem("deliveryDate","0"),localStorage.setItem("deliveryAddress","pickup: ".concat(e))},r=function(e){var t=e.pickupModule,n=e.pointsWrapper,a=e.deliveryPoints,i=e.chosenCity;return r.initiate=function(){var e=function(t,r,n,a){var i,o,c=!1;return e.checkRender=function(){return c=t.dataset.rendered,e},e.fillModule=function(){return c||(Array.isArray(n.city)?n.city.forEach(function(e,t){return r.append(function(e,t){var r=document.createElement("p");return r.classList.add("delivery-pickup__point"),r.textContent="".concat(e,", ").concat(t),r}(e,n.address[t]))}):r.append(function(e,t){var r=document.createElement("p");return r.classList.add("delivery-pickup__no-point"),r.innerHTML="".concat(e,"<br/>").concat(t),r}(n.city,n.address)),t.dataset.rendered="1"),e},e.getUserCity=function(){return i=a.textContent,e},e.setUserCity=function(){return i?o=i:(o=getCookie("deliveryCity")||YMaps.location.city||"Ярославль",h.setText(a,o)),e},e};return e(t,n,a,i).checkRender().fillModule().getUserCity().setUserCity(),r},r},n=function(e){var r,a,i,o=e.input,c=e.pointsWrapper,l=e.pickupModule,s=e.changeCity,u=function(){},d=function(){},p=function(){},f=function(){},m=[],v=l.dataset.deliveryPoint||"";return n.create=function(){return u=function(e){var t=h.escapeHtml(e.target.value),n=function(e){var t,i=function(e){return e.toLowerCase()};return n.getAllPoints=function(){return r=r||_toConsumableArray(c.querySelectorAll(".delivery-pickup__point")),n},n.inputString=function(){return 3>e.length?a?(n.filterPoints("remove"),a=!1,t=!0,n):(t=!0,n):(e=i(e),n)},n.filterPoints=function(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"add";return t?n:(_toConsumableArray(r).forEach(function(t){var r=i(t.textContent);return 0<e.length&&~r.indexOf(e)?void h.handleClass(t,"remove","hidden"):(h.handleClass(t,o,"hidden"),void(a=!0))}),n)},n};n(t).getAllPoints().inputString().filterPoints()},u=_.debounce(u,300),d=function(e){var r=function(e){var n,a,o,s=e.target,u=function(){return u.setFastExit=function(e){return n=e,u},u.setSelected=function(e){return o=e,u},u.setPrevEl=function(e){return a=e,u},u.clearSavedInfo=function(){return h.setDataSet(l,"deliveryPoint",""),localStorage.setItem("deliveryAddress",""),localStorage.setItem("deliveryDate",""),h.saveAllCookie({type:null,address:null,id:null,deadline:null,cost:null,courier:null}),u},u.clearChosenPoint=function(){return h.removeElement(i),u},u.setChosenPoint=function(){return v=s.textContent,h.setDataSet(l,"deliveryPoint",v),u},u.saveStorageInfo=function(){return t(v),h.saveAllCookie({type:"pickup",address:v,id:"",deadline:"0",cost:"0",city:v.split(",")[0]}),u},u};return r.checkEl=function(){return s.classList.contains("delivery-pickup__point")?(s.classList.contains("delivery-pickup__point--active")?u().setFastExit(!0).setSelected(!0):u().setPrevEl(c.querySelector(".delivery-pickup__point--active")),r):(u().setFastExit(!0),r)},r.saveInfo=function(){return o?(u().clearSavedInfo().clearChosenPoint(),r):(n||u().setChosenPoint().saveStorageInfo(),r)},r.setStatus=function(){return n||h.handleClass(s,"add","delivery-pickup__point--active"),o&&h.handleClass(s,"remove","delivery-pickup__point--active"),a&&h.handleClass(a,"remove","delivery-pickup__point--active"),r},r};r(e).checkEl().saveInfo().setStatus()},p=function(){var e=function(){return e.restorePoints=function(){return _toConsumableArray(c.children).forEach(function(e){return h.handleClass(e,"remove","hidden")}),e},e.hide=function(){return h.handleClass(l,"add","hidden"),e},e.inputClear=function(){return o.value="",e},e.removeListeners=function(){return m.forEach(function(e){return function(e,t,r){return e.removeEventListener(t,r)}(e[0],e[1],e[2])}),e},e.disableBlockScreen=function(){return h.handleClass(blockScreen,"add","hidden"),e},e.blockConfirmButton=function(){return e},e.callCustomEvent=function(){return l.dispatchEvent(customEvent),e},e};e().hide().restorePoints().inputClear().removeListeners().blockConfirmButton().disableBlockScreen().callCustomEvent()},function(){var e=function(){return e.closeModule=function(){return p(),e},e.saveInfo=function(){return t(v),e},e};e().saveInfo().closeModule()},f=function(){h.saveAllCookie({type:null,address:null,id:null,deadline:null,cost:null,courier:null}),sessionStorage.setItem("fromBasket","y"),sessionStorage.setItem("haveToOpenPickupModule","y"),sessionStorage.setItem("prevBasketPage","2"),sessionStorage.setItem("fromPickup","y"),sessionStorage.setItem("backFromPickup","y"),location.assign("/kontakty.html")},n},n.add=function(){return(m=[[o,"input",u],[c,"click",d],[s,"click",f]]).forEach(function(e){return function(e,t,r){return e.addEventListener(t,r)}(e[0],e[1],e[2])}),n},n};r(e).initiate(),n(e).create().add()}(_.extend(t,{pointsWrapper:t.pickupModule.querySelector(".delivery-pickup__points-list"),input:t.pickupModule.querySelector(".delivery-pickup__input"),chosenCity:t.pickupModule.querySelector(".delivery-pickup__chosen-city"),changeCity:t.pickupModule.querySelector(".delivery-pickup__change-city"),deliveryPoints:e}))},window.deliverySelfExport=function(){var e={selfExportModule:document.querySelector(".delivery-selfExport"),JCShiptorWidgetPvz:document.querySelector("#shiptor_widget_pvz"),map:document.querySelector('[data-role="shiptor_widget_show"]')};!function(e){var t={onChangeCity:function(){},onShowMapClick:function(){},onPickupConfirm:function(){},onPickupInput:function(){},onPickupPointClick:function(){},onCloseClick:function(){},onMapClose:function(){}},r=function(e,t,r){localStorage.setItem("deliveryDate",h.getDataSet(e,"deliveryPeriod")),localStorage.setItem("deliveryAddress","delivery: ".concat(t," | ").concat(r))},n=function(e){var t,r,n=e.result.methods;try{t=n[0].min_days}catch(e){var a=e.message;console.log(a),t=0}try{r=n[0].max_days}catch(e){var i=e.message;console.log(i),r=0}return[t,r]},a=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"77000000000";return new ShiptorPointsGetter({usersCity:e,fromCity:t})},i=function(e){var t=e.itemList,r=e.childClassName,n=e.wrapper,a=e.fastExit,i=e.isCityFiltered,o=e.firstInitiate,c=!(void 0!==o)||o;return function(e){var o=h.escapeHtml(e.target.value),l=function(e){var o;return l.initiate=function(){return c&&(t="pickup"===t?n.querySelector(".delivery-selfExport__pickup-list"):n.querySelector(".delivery-selfExport__cities-list")),c=!1,l},l.getAllPoints=function(){return o=_toConsumableArray(t.querySelectorAll(r)),l},l.inputString=function(){return 3>e.length?i?(l.filterPoints("remove"),i=!1,a=!0,l):(a=!0,l):(e=h.lowerCase(e),l)},l.filterPoints=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"add";return a?l:(o.forEach(function(r){var n=r.dataset.value;return h.checkSubString(n,e)?void h.handleClass(r,"remove","hidden"):(h.handleClass(r,t,"hidden"),void(i=!0))}),l)},l.clearClosure=function(){return a="",l},l};l(o).initiate().getAllPoints().inputString().filterPoints().clearClosure()}},o=function(e){var t=e.selfExportModule,r=e.pickupList,i=e.chosenCity,c=e.pickupSection,l=e.pickupSearchInput,s=e.JCShiptorWidgetPvz,u=e.waitScreen,d=e.errorSection;return o.initiate=function(){var e=function(){var o,p,f,m,v=!1,y=+localStorage.getItem("needRerender");return e.showPickupSection=function(){return h.show(c),e},e.setWaitScreen=function(){return h.setWaitScreen(u),e},e.getUserCity=function(){return o=i.textContent,e},e.setUserCity=function(){return o?p=o:(p=getCookie("deliveryCity")||YMaps.location.city||"Ярославль",h.setText(i,p)),e},e.checkRender=function(){var r=function(){return r.getRenderedPoints=function(){return v=h.getDataSet(t,"renderedPoints"),r},r.getRenderedCity=function(){return o!==h.getDataSet(t,"renderedCity")&&(o=""),r},r.setRenderedCity=function(){return h.setDataSet(t,"renderedCity",p),r},r};return r().getRenderedCity().getRenderedPoints().setRenderedCity(),e},e.handleDeliveryPoints=function(){if(!v||!o||y){var i=function(){return i.clearLocalRerenderInfo=function(){return localStorage.setItem("needRerender",""),y=!1,i},i.cleaPickupInput=function(){return h.clearInput(l),i},i.clearPickupList=function(){return h.clearEl(r),i},i.initiateApi=function(){return m=a(p,"77000000000"),i},i.handleRequest=function(){m.getUsersCityKladr().then(function(e){var r;try{r=e.result[0].kladr_id}catch(e){var n=e.message;console.log(n),r="11001110011"}return h.setDataSet(t,"cityKladr",r),r}).then(function(e){return h.setDataSet(s,"cityKladr",e)}).then(function(e){return i.setKladrId(e)}).then(function(){return window.JCShiptorWidgetPvz.hide()}).then(function(){return m.calculateShipping()}).then(function(e){var r=_slicedToArray(n(e),2),a=r[0],i=r[1];[a+0,i+0],h.setDataSet(t,"deliveryPeriod",i||a)}).then(function(){m.getDeliveryPoints().then(function(e){return 1>e.result.length&&h.showError(d),i.filterPoints(e)}).then(function(){h.setDataSet(t,"renderedPoints",1),e.checkRender(),o=p}).then(function(){return e.disableWaitScreen(u)})})},i.filterPoints=function(e){var t=e.result;return f=t.filter(function(e){return e.active}),i.renderDeliveryPoints(f),i},i.renderDeliveryPoints=function(e){var t=function(e){var t=e.courier,r=e.address,n=e.prepare_address,a=e.id,i=function(e,t){var r,n,a;try{"object"===_typeof(e=e||t)?(r=e.street,n=e.house,a="".concat(r," ").concat(n)):(a=(a=t).split(", "),a="".concat(a[1]," ").concat(a[2]))}catch(t){}return a}(n,r),o=document.createElement("li");h.handleClass(o,"add","delivery-selfExport__pickup-point"),h.setDataSet(o,"value",i),h.setDataSet(o,"id",a),h.setDataSet(o,"courier",t);var c=document.createElement("p");return h.handleClass(c,"add","delivery-selfExport__address"),h.setText(c,r),o.append(c),o},n=document.createDocumentFragment();e.forEach(function(e){n.append(t(e))}),r.append(n)},i.setKladrId=function(e){return window.JCShiptorWidgetPvz.setParams({location:{kladr_id:e}}),window.JCShiptorWidgetPvz.refresh(),i},i};return i().clearLocalRerenderInfo().cleaPickupInput().clearPickupList().initiateApi().handleRequest(),e}return e.disableWaitScreen(u),e},e.disableWaitScreen=_asyncToGenerator(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.disableWaitScreen(u);case 2:return t.abrupt("return",e);case 3:case"end":return t.stop()}},t)})),e};e().showPickupSection().setWaitScreen().getUserCity().setUserCity().checkRender().handleDeliveryPoints()},o},c=function(e){var n=e.changeCity,a=e.showMap,o=e.pickupSection,l=e.citiesList,s=e.selfExportModule,u=e.citiesSection,d=e.pickupSearchInput,p=e.pickupList,f=e.JCShiptorWidgetPvz,m=e.map,v=[],y="".concat(s.dataset.renderedCity,", ").concat(s.dataset.deliveryPoint)||"",k=h.getDataSet(p.querySelector(".delivery-selfExport__pickup-point--active"),"courier"),b=new Event("ClosePickupModule",{bubbles:!0});return c.create=function(){return t.onChangeCity=function(){h.saveAllCookie({type:null,address:null,id:null,deadline:null,cost:null,courier:null}),sessionStorage.setItem("fromBasket","y"),sessionStorage.setItem("prevBasketPage","2"),location.assign("/kontakty.html")},t.onPickupInput=_.partial(i,{itemList:"pickup",childClassName:".delivery-selfExport__pickup-point",wrapper:s}),t.onPickupInput=_.debounce(t.onPickupInput(),300),t.onPickupPointClick=function(e){var t=function(e){var n,a,i,o=e.target,c=function(){return c.setFastExit=function(e){return n=e,c},c.setSelected=function(e){return i=e,c},c.setPrevEl=function(e){return a=e,c},c.clearSavedInfo=function(){return h.setDataSet(s,"deliveryPoint",null),h.clearStorage(["deliveryDate","deliveryAddress"]),h.saveAllCookie({type:null,address:null,id:null,deadline:null,cost:null,courier:null}),c},c.clearChosenPoint=function(){return h.removeElement(void 0),c},c.setChosenPoint=function(){return y=o.querySelector(".delivery-selfExport__address").textContent,k=h.getDataSet(o,"courier"),h.setDataSet(s,"deliveryPoint",h.getDataSet(o,"value")),c},c.setStorageInfo=function(){return r(s,y,k),h.saveAllCookie({type:"selfExport",address:y,id:h.getDataSet(o,"id"),deadline:s.dataset.deliveryPeriod,cost:window.citiesList[0].price,courier:k}),c},c};return t.checkEl=function(){var e=h.lowerCase(o.tagName);return"li"!==e&&"p"!==e?(c().setFastExit(!0),t):("p"===e&&(o=o.parentElement),o.classList.contains("delivery-selfExport__pickup-point--active")?c().setFastExit(!0).setSelected(!0):c().setPrevEl(p.querySelector(".delivery-selfExport__pickup-point--active")),t)},t.saveInfo=function(){return i?(c().clearSavedInfo().clearChosenPoint(),t):(n||c().setChosenPoint().setStorageInfo(),t)},t.setStatus=function(){return n||h.handleClass(o,"add","delivery-selfExport__pickup-point--active"),i&&h.handleClass(o,"remove","delivery-selfExport__pickup-point--active"),a&&h.handleClass(a,"remove","delivery-selfExport__pickup-point--active"),t},t};t(e).checkEl().saveInfo().setStatus()},t.onCloseClick=function(){var e=function(){return e.restorePoints=function(){return _toConsumableArray(p.children).forEach(function(e){return h.handleClass(e,"remove","hidden")}),e},e.hide=function(){return[s,o,u].forEach(h.hide),e},e.inputClear=function(){return d.value="",e},e.showAllCities=function(){return h.showAll(l.children),e},e.removeListeners=function(){return h.removeListOfEvents(v,"closeModule"),e},e.callCustomEvent=function(){return s.dispatchEvent(b),e},e};e().hide().restorePoints().inputClear().showAllCities().removeListeners().callCustomEvent()},t.onPickupConfirm=function(){r(s,y,k),t.onCloseClick()},t.onShowMapClick=function(){var e=function(){return e.mapCall=function(){return m.click(),e},e};e().mapCall()},t.onMapClose=function(e){var r=function(){return r.handleData=function(e){var n=e.detail.address,a=function(){var e;return a.handleGettedAddress=function(){return n=h.lowerCase(n),a},a.getChosenPickupFromList=function(){return e=_toConsumableArray(p.children).filter(function(e){var t=h.lowerCase(e.querySelector(".delivery-selfExport__address").textContent);return h.isMatch(t,n)}),a},a.handleChosenPoint=function(){return e?((e=e[0]).click(),a):void alert("Автоматически пункт выдачи не найден :( \n Попробуйте самостоятельно найти в списке")},a.sortPickupList=function(){return e.remove(),p.prepend(e),a},a.clearPreviousSearch=function(){return t.onPickupInput({target:{value:""}}),a},a};return a().handleGettedAddress().getChosenPickupFromList().handleChosenPoint().sortPickupList().clearPreviousSearch(),r},r};r().handleData(e)},c},c.listInitiate=function(){return v=[{element:n,ev:"click",listener:t.onChangeCity,changeCityRemove:!0,cityConfirmAdd:!0,boot:!0},{element:a,ev:"click",listener:t.onShowMapClick,changeCityRemove:!0,cityConfirmAdd:!0,boot:!0},{element:d,ev:"input",listener:t.onPickupInput,changeCityRemove:!0,cityConfirmAdd:!0,boot:!0},{element:p,ev:"click",listener:t.onPickupPointClick,changeCityRemove:!0,cityConfirmAdd:!0,boot:!0},{element:f,ev:"onPvzSelect",listener:t.onMapClose,boot:!0}],c},c.add=function(){return h.addListOfEvents(v,"boot"),c},c};o(e).initiate(),c(e).create().listInitiate().add()}(_.extend(e,{citiesList:e.selfExportModule.querySelector(".delivery-selfExport__cities-list"),pickupList:e.selfExportModule.querySelector(".delivery-selfExport__pickup-list"),pickupSection:e.selfExportModule.querySelector(".delivery-selfExport__pickup"),citiesSection:e.selfExportModule.querySelector(".delivery-selfExport__cities"),citySearchInput:e.selfExportModule.querySelector(".delivery-selfExport__city-search-input"),pickupSearchInput:e.selfExportModule.querySelector(".delivery-selfExport__pickup-search-input"),errorSection:e.selfExportModule.querySelector(".delivery-selfExport__error"),waitScreen:e.selfExportModule.querySelector(".delivery-selfExport__wait-screen"),chosenCity:e.selfExportModule.querySelector(".delivery-selfExport__chosen-city"),changeCity:e.selfExportModule.querySelector(".delivery-selfExport__change-city"),showMap:e.selfExportModule.querySelector(".delivery-selfExport__show-map")}))},function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==_typeof(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)t.d(n,a,function(t){return e[t]}.bind(null,a));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(e){e.exports=React},function(e){e.exports=ReactDOM},function(e,t,r){function n(){return(n=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}function a(){return(a=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}function i(){return(i=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}function o(){return(o=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}r.r(t);var c=r(0),l=r.n(c),s=function(e){var t=_extends({},e);return l.a.createElement("button",t,"Продолжить")},u=function(e){var t=function(e){return Array.isArray(e)?e.reduce(function(e,t){return e[t]=function(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}(t),e},{}):e},r=_slicedToArray(Object(c.useState)(t(e)),2),n=r[0],a=r[1];return Object(c.useEffect)(function(){n&&Object.keys(n)[0]&&Object.keys(n).forEach(function(e){return n[e]&&function(e,t){var r={path:"/",secure:!0,"max-age":new Date(Date.now()+864e7)},n=encodeURIComponent(e)+"="+encodeURIComponent(t);for(var a in r){n+="; "+a;var i=r[a];!0!==i&&(n+="="+i)}document.cookie=n}(e,n[e])})},[n]),[n,function(){return a(function(e){return t(Object.keys(e))})}]},d=Object(c.createContext)([{},function(){}]),p=function(e){var t=e.children,r=_slicedToArray(u(["deliveryAddress","deliveryType","deliveryCost","deliveryDeadline","selfExportPointId","deliveryCity"]),2),n=r[0],a=r[1],i=_slicedToArray(Object(c.useState)(_objectSpread({},n,{pickup:{header:"Офисы самовывоза",linkText:"Выбрать другое место самовывоза",showModule:!1},selfExport:{header:"Пункты доставки",linkText:"Выбрать другой пункт выдачи",showModule:!1}})),2),o=i[0],s=i[1];return l.a.createElement(d.Provider,{value:[o,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return a(),s(function(t){return _objectSpread({},t,n,e)}),o}]},t)},f=Object(c.createContext)([{},function(){}]),m=function(e){var t=e.children,r=_slicedToArray(function(e){var t=_slicedToArray(u("string"==typeof e&&[e]||e),2),r=t[0],n=t[1],a=_slicedToArray(Object(c.useState)(!1),2),i=a[0],o=a[1];return Object(c.useEffect)(function(){o(r&&Object.keys(r).every(function(e){return!!r[e]}))},[r]),[i,function(){return n()}]}(["deliveryAddress","deliveryType","deliveryCost","deliveryDeadline"]),2),n=r[0],a=r[1];return l.a.createElement(f.Provider,{value:[n,a]},t)},v=function(e){var t=e.className,r=e.next,n=e.setNext,a=_slicedToArray(Object(c.useContext)(f),2)[1],i=_slicedToArray(Object(c.useContext)(d),2),o=i[0].pickup,u=i[1];return Object(c.useEffect)(function(){window.deliveryPickup()},[]),l.a.createElement("div",{className:"delivery-pickup ".concat(t||""),"data-delivery-type":"Самовывоз"},l.a.createElement("div",{className:"delivery-pickup__chosen-city-wrapper"},l.a.createElement("p",{className:"delivery-pickup__chosen-city-descr"},"Текущий город: "),l.a.createElement("p",{className:"delivery-pickup__chosen-city"}),l.a.createElement("button",{className:"delivery-pickup__change-city"},"Выбрать другой город")),l.a.createElement("input",{type:"text",className:"delivery-pickup__input",placeholder:"Введите улицу"}),l.a.createElement("header",{className:"delivery-pickup__points-header"},o.header),l.a.createElement("div",{className:"delivery-pickup__points-list",onClick:function(e){var t=e.target;a(),u(),t.classList.contains("delivery-pickup__point--active")?n(!0):n(!1)}}),r&&l.a.createElement(s,{onClick:function(){var e=o.showModule;u({pickup:_objectSpread({},o,{showModule:!e})})},className:"delivery-pickup__continue-btn"}))},h=function(e){var t=e.deliveryType,r=e.setNext,n=e.next,a=_slicedToArray(Object(c.useContext)(d),2),i=a[0],o=a[1],s=i[t],u=i.deliveryAddress,p=s.showModule,f=s.linkText;return Object(c.useEffect)(function(){var e=!u&&sessionStorage.getItem("haveToOpenPickupModule");e&&sessionStorage.removeItem("haveToOpenPickupModule"),o(_defineProperty({},t,_objectSpread({},s,{showModule:e?!p:p})))},[n]),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"basket__react-delivery-choose-point"},"Текущий пункт выдачи: ",l.a.createElement("strong",{className:"basket__react-delivery-strong"},t===i.deliveryType?i.deliveryAddress:"не выбран")),l.a.createElement("button",{onClick:function(){r(!1),o(_defineProperty({},t,_objectSpread({},s,{showModule:!p})))},className:"basket__react-delivery-choose-pickAnotherPoint"},f))},y=function(e){var t=e.text,r=e.className;return l.a.createElement("div",{className:"basket__react-additional-info-item basket__react-additional-info-item--"+r},t)},_=function(){var e=_slicedToArray(Object(c.useState)({header:"",name:"",phone:"",schedule:"",mapLink:""}),2),t=e[0],r=e[1],n=_slicedToArray(Object(c.useContext)(d),1)[0],a=n.deliveryType,i=n.deliveryCity,o=n.deliveryAddress;Object(c.useEffect)(function(){try{"pickup"===a?function(){var e=window.citiesList.filter(function(e){return e.name===i})[0],t=e.mapLink,n=void 0===t?"":t,a=_objectSpread({},e.branches.filter(function(e){return e.name===o})[0]);r(_objectSpread({},a,{header:"Контактная информация",mapLink:n}))}():function(e,t){var n=new ShiptorPointsGetter({usersCity:e,fromCity:"_"});n.getUsersCityKladr().then(function(){n.getDeliveryPoints().then(function(e){var n=e.result.filter(function(e){return e.id===t});try{var a=_slicedToArray(n,1)[0],i=a.address,o=a.phones,c=void 0===o?[]:o,l=a.work_schedule;r({header:"Контактная информация",name:i,phone:c[0]&&c.reduce(function(e,t){return"".concat(e," + /n + ").concat(t)}),schedule:l,mapLink:""})}catch(n){var s=n.message;console.log(s)}})})}(getCookie("deliveryCity"),+getCookie("selfExportPointId"))}catch(t){var e=t.message;console.log(e)}},[]);var s=t.header,u=void 0===s?"":s,p=t.name,f=void 0===p?"":p,m=t.phone,v=void 0===m?"":m,h=t.schedule,_=void 0===h?"":h,k=t.mapLink,b=void 0===k?"":k;return(u&&f||b)&&l.a.createElement("section",{className:"basket__react-additional-info"},l.a.createElement("header",{className:"basket__react-additional-info-header"},u),l.a.createElement("div",{className:"basket__react-additional-info-body"},l.a.createElement("div",{className:"basket__react-additional-info-left-part"},function(){var e={name:f,phone:v,schedule:_};return Object.keys(e).map(function(t){return e[t]&&l.a.createElement(y,{text:e[t],className:t})})}()),l.a.createElement("div",{className:"basket__react-additional-info-right-part"},b&&l.a.createElement("iframe",{src:b,width:"100%",height:"100%",frameBorder:"0"}))))},k=function(e){var t=e.deliveryType,r=_objectWithoutProperties(e,["deliveryType"]),a=_slicedToArray(Object(c.useContext)(d),1)[0],i=a.deliveryType,o=a.pickup.showModule;return l.a.createElement(l.a.Fragment,null,l.a.createElement(h,n({deliveryType:t},r)),o?l.a.createElement(v,r):t===i&&l.a.createElement(_,null))},b=function(e){var t=e.className,r=e.next,n=e.setNext,a=_slicedToArray(Object(c.useContext)(f),2)[1],i=_slicedToArray(Object(c.useContext)(d),2),o=i[0].selfExport,u=i[1];return Object(c.useEffect)(function(){window.deliverySelfExport()},[]),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"delivery-selfExport ".concat(t),"data-delivery-type":"Пункт выдачи"},l.a.createElement("div",{className:"delivery-selfExport__wait-screen hidden preloader-mini"},l.a.createElement("div",{className:"preloader-mini__item"},l.a.createElement("div",{className:"preloader-mini__item-tool"}),l.a.createElement("div",{className:"preloader-mini__item-tool"}),l.a.createElement("div",{className:"preloader-mini__item-tool"}),l.a.createElement("div",{className:"preloader-mini__item-tool"}))),l.a.createElement("div",{className:"delivery-selfExport__chosen-city-wrapper"},l.a.createElement("p",{className:"delivery-selfExport__chosen-city-descr"},"Текущий город: "),l.a.createElement("p",{className:"delivery-selfExport__chosen-city"}),l.a.createElement("button",{className:"delivery-selfExport__change-city"},"Выбрать другой город")),l.a.createElement("section",{className:"delivery-selfExport__pickup"},l.a.createElement("header",{className:"delivery-selfExport__pickup-header"},l.a.createElement("p",{className:"delivery-selfExport__pickup-header-text"},"Пункты выдачи"),l.a.createElement("button",{className:"delivery-selfExport__show-map"},"Посмотреть на карте")),l.a.createElement("input",{type:"text",className:"delivery-selfExport__pickup-search-input",placeholder:"Поиск пункта выдачи"}),l.a.createElement("ul",{onClick:function(e){var t=e.target;a(),u(),t.classList.contains("delivery-selfExport__pickup-point--active")||t.parentElement.classList.contains("delivery-selfExport__pickup-point--active")?n(!0):n(!1)},className:"delivery-selfExport__pickup-list"}),r&&l.a.createElement(s,{onClick:function(){var e=o.showModule;u({selfExport:_objectSpread({},o,{showModule:!e})})},className:"delivery-pickup__continue-btn"})),l.a.createElement("section",{className:"delivery-selfExport__error hidden"},l.a.createElement("p",{className:"delivery-selfExport__error-text"},"К сожалению пункты выдачи не найдены :(",l.a.createElement("br",null),"Попробуйте сменить город"))))},g=function(e){var t=e.deliveryType,r=_objectWithoutProperties(e,["deliveryType"]),n=_slicedToArray(Object(c.useContext)(d),1)[0],i=n.deliveryType,o=n.selfExport.showModule;return l.a.createElement(l.a.Fragment,null,l.a.createElement(h,a({deliveryType:t},r)),o?l.a.createElement(b,r):t===i&&l.a.createElement(_,null))},E=function(e){var t=e.onTabClick,r=e.deliveryType,n="pickup"===r,a=_objectSpread({deliveryType:r},_objectWithoutProperties(e,["onTabClick","deliveryType"])),i="basket__progress-header-item basket__progress-header-item--without-before ".concat(n&&"basket__progress-header-item--active"),o="basket__progress-header-item basket__progress-header-item--without-before ".concat(!n&&"basket__progress-header-item--active");return l.a.createElement(l.a.Fragment,null,l.a.createElement("ul",{className:"basket__tabs-wrapper"},l.a.createElement("li",{className:i,onClick:function(){return t("pickup")}},"Самовывоз"),l.a.createElement("li",{className:o,onClick:function(){return t("selfExport")}},"Доставка")),n?l.a.createElement(k,a):l.a.createElement(g,a))},C=function(e){var t=e.header;return l.a.createElement("header",{className:"basket__react-stage-header"},t)},S=function(e){var t=e.header,r=_objectWithoutProperties(e,["header"]);return l.a.createElement(l.a.Fragment,null,l.a.createElement(C,{header:t}),l.a.createElement(E,r))},x=function(e){var t=e.name,r=(e.date,e.count),n=e.price,a=e.link;return l.a.createElement("li",{className:"basket__react-final-goods-item"},l.a.createElement("a",{href:a,className:"basket__react-final-goods-item-link"},l.a.createElement("p",{className:"basket__react-final-goods-item-name"},t)),l.a.createElement("p",{className:"basket__react-final-goods-item-count"},r," шт."),l.a.createElement("p",{className:"basket__react-final-goods-item-price"},n*r," р."))},w=function(){var e=window.basketApi.getBasketItems();return l.a.createElement("ul",{className:"basket__react-final-goods-item-list"},e.map(function(e){return l.a.createElement(x,e)}))},P=function(){var e=parseInt(window.basketApi.getTotalPricesAndItems().replace("Итого ","")),t=window.basketApi.getItemsPrice();return l.a.createElement("header",{className:"basket__react-final-goods-header"},l.a.createElement("p",{className:"basket__react-final-goods-header-positions"},function(e){switch(!0){case"1"===e.toString().slice(-1):return"".concat(e," позиция");case 1<+e.toString().slice(-1)&&5>+e.toString().slice(-1):return"".concat(e," позиции");default:return"".concat(e," позиций")}}(e),l.a.createElement("button",{className:"basket__react-final-goods-open-button",onClick:function(e){var t=e.target,r=document.querySelector(".basket__react-final-goods-item-list"),n=r.style.display;"none"!==n&&n?($(r).slideUp(),t.classList.remove("basket__react-final-goods-open-button--open")):($(r).slideDown(),t.classList.add("basket__react-final-goods-open-button--open"))}},"Открыть")),l.a.createElement("p",{className:"basket__react-final-goods-header-price"},t," р."))},A=function(){return l.a.createElement("div",{className:"basket__react-final-goods"},l.a.createElement(P,null),l.a.createElement(w,null))},N=function(){var e=_slicedToArray(Object(c.useContext)(d),1)[0].deliveryType;return l.a.createElement("header",{className:"basket__react-final-delivery-header"},l.a.createElement("p",{className:"basket__react-final-delivery-price-text"},"pickup"===e?"Самовывоз":"Доставка"),l.a.createElement("p",{className:"basket__react-final-delivery-price"},"".concat(getCookie("deliveryCost")||0," р.")))},j=function(){var e=window.basketApi.getMaxDeliveryDate();return l.a.createElement("div",{className:"basket__react-final-delivery-deadline"},l.a.createElement("p",{className:"basket__react-final-delivery-deadline-text"},"Срок доставки"),l.a.createElement("p",{className:"basket__react-final-delivery-deadline-days"},e," дн."))},L=function(){return l.a.createElement("div",{className:"basket__react-final-delivery-body"},l.a.createElement("div",{className:"basket__react-final-delivery-address-wrapper"},l.a.createElement("p",{className:"basket__react-final-delivery-address"},getCookie("deliveryAddress")||"")),l.a.createElement(j,null))},T=function(){return l.a.createElement("div",{className:"basket__react-final-delivery"},l.a.createElement(N,null),l.a.createElement(L,null))},I=function(){return l.a.createElement("div",{className:"basket__react-final-body"},l.a.createElement(A,null),l.a.createElement(T,null))},O=function(){return l.a.createElement(I,null)},M=function(){return l.a.createElement(O,null)},D=function(e){var t=e.text,r=e.available,n=_objectWithoutProperties(e,["text","available"]);return l.a.createElement("button",i({},n,{disabled:!r}),l.a.createElement("span",{className:"basket__react-bottom-nav-btn-text"},t),l.a.createElement("span",{className:"basket__react-bottom-nav-btn-arrow"}))},q=function(e){var t=e.step,r=e.onClick,n=_slicedToArray(Object(c.useContext)(f),1)[0];return l.a.createElement("div",{className:"basket__react-bottom-nav"},function(){var e={2:{text:["К корзине","Далее"],className:["basket__react-bottom-nav-btn","basket__react-bottom-nav-btn"],onClick:[window.basketApi.returnToBasket,r.bind(null,"add")],available:[!0,n]},3:{text:["Назад","Оформить"],className:["basket__react-bottom-nav-btn","basket__react-bottom-nav-btn basket__react-bottom-nav-btn--confirm"],onClick:[r.bind(null,"sub"),function(e){e.preventDefault(),window.location.assign("/orders/new")}],available:[!0,n]}};return[,,].fill("").map(function(r,n){var a=e[t],i=a.text,o=a.className,c=a.onClick,s=a.available;return l.a.createElement(D,{key:n,text:i[n],className:o[n],onClick:c[n],available:s[n]})})}())},R=function(e){var t=e.next,r=e.step,n=_slicedToArray(u(["deliveryCost"]),2),a=n[0].deliveryCost,i=n[1];return Object(c.useEffect)(function(){return i()},[t]),l.a.createElement("div",{className:"basket__react-bottom-info"},function(){var e=window.basketApi.getTotalPricesAndItems(),t=a?"".concat(a," р"):"не выбран пункт выдачи";return[{text:e.split(":")[0],value:e.split(":")[1],className:"basket__react-bottom-info-item basket__react-bottom-info-item--products",step:[2]},{text:"Стоимость доставки",value:t,className:"basket__react-bottom-info-item basket__react-bottom-info-item--delivery",step:[2]},{text:"Сумма к оплате",value:" ".concat(window.basketApi.getTotalSum().toLocaleString()," р."),className:"basket__react-bottom-info-item basket__react-bottom-info-item--common",step:[3]}].filter(function(e){return e.step.includes(r)}).map(function(e,t){var r=e.text,n=e.value,a=e.className;return l.a.createElement("div",{key:t,className:a},r,": ",l.a.createElement("span",{className:"basket__react-bottom-info-item-mark"},n))})}())},B=function(){return l.a.createElement("div",{className:"basket__react-bottom-message"},l.a.createElement("p",{className:"basket__react-bottom-message-text"},"Обращаем Ваше внимание, что стоимость доставки предварительная. Окончательная стоимость доставки будет рассчитана менеджером, исходя из веса и объема заказанных товаров."))},W=function(e){var t=_extends({},e);return l.a.createElement(l.a.Fragment,null,l.a.createElement("section",{className:"basket__react-bottom-panel"},l.a.createElement(R,t),l.a.createElement(q,t)),l.a.createElement(B,null))},F=function(e){var t=e.text,r=e.className,n=e.onClick;return l.a.createElement("li",{onClick:n,className:r.join(" ")},t)},H=function(e){var t=e.header,r=e.onClick,n=(e.setStep,_objectWithoutProperties(e,["header","onClick","setStep"])),a=["Корзина","Способ доставки","Подтверждение заказа"],i=_slicedToArray(Object(c.useContext)(f),1)[0];return l.a.createElement("ul",{className:"basket__progress-header"},function(e){return a.map(function(t,a){var c=window.innerWidth,s=_objectSpread({},n,{text:450<c?t:a+1,className:function(){var r=["basket__progress-header-item"];return e===t&&r.push("basket__progress-header-item--active"),r}(),onClick:function(e){return 0===e?(r.bind(null,"sub")(),window.basketApi.returnToBasket()):1===e?r.bind(null,"sub")():2===e?i?r.bind(null,"add")():function(){}:void 0}.bind(null,a)});return l.a.createElement(F,o({key:a},s))})}(t))},U=r(1);r.n(U).a.render(l.a.createElement(function(){var e={2:"Способ доставки",3:"Подтверждение заказа"},t=_slicedToArray(Object(c.useState)(!1),2),r=t[0],n=t[1],a=_slicedToArray(u(["deliveryType"]),1)[0].deliveryType,i=_slicedToArray(Object(c.useState)(a||"pickup"),2),o=i[0],s=i[1],d=_slicedToArray(Object(c.useState)(function(){var e=sessionStorage.getItem("prevBasketPage");return sessionStorage.removeItem("prevBasketPage"),e&&+e}()||2),2),f=d[0],v=d[1],h=function(e,t){var r="add"===e?t+1:t-1;return 4>r&&1<r?r:t},y=2===f?l.a.createElement(S,{header:e[f],onTabClick:function(e){return s(e)},deliveryType:o,next:r,setNext:n}):l.a.createElement(M,null);return l.a.createElement(p,null,l.a.createElement(m,null,l.a.createElement(H,{setStep:v,header:e[f],onClick:function(e){return v(function(t){return h(e,t)})}}),y,l.a.createElement(W,{onClick:function(e){return v(function(t){return h(e,t)})},step:f,next:r})))},null),document.querySelector(".basket__stages"))}]);