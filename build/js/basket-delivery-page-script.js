"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function asyncGeneratorStep(e,t,r,n,a,i,o){try{var c=e[i](o),l=c.value}catch(e){return void r(e)}c.done?t(l):Promise.resolve(l).then(n,a)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){function i(e){asyncGeneratorStep(c,n,a,i,o,"next",e)}function o(e){asyncGeneratorStep(c,n,a,i,o,"throw",e)}var c=e.apply(t,r);i(void 0)})}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(e,t){var r=[],n=!0,a=!1,i=void 0;try{for(var o,c=e[Symbol.iterator]();!(n=(o=c.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(a)throw i}}return r}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null==arguments[t]?{}:arguments[t],n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){_defineProperty(e,t,r[t])})}return e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}}window.citiesList=[{name:"Абакан",kladr_id:"19000001000",firstLetter:"А",price:"450"},{name:"Альметьевск",kladr_id:"16008001000",price:"450"},{name:"Анадырь",kladr_id:"87000001000",price:"450"},{name:"Архангельск",kladr_id:"29000001000",price:"450"},{name:"Астрахань",kladr_id:"30000001000",price:"450"},{name:"Барнаул",kladr_id:"22000001000",firstLetter:"Б",branches:{office:[{name:"Барнаул, ул. Попова 248/2",street:"ул. Попова, 248/2",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"28"}]},mapLink:""},{name:"Белгород",kladr_id:"31000001000",price:"450"},{name:"Биробиджан",kladr_id:"79000001000",price:"450"},{name:"Благовещенск",kladr_id:"28000001000",price:"450"},{name:"Братск",kladr_id:"38000005000",price:"450"},{name:"Брянск",kladr_id:"32000001000",price:"450"},{name:"Бугульма",kladr_id:"16014001000",price:"450"},{name:"Бузулук",kladr_id:"56000006000",branches:{office:[{name:"Бузулук, ул. Дорожная 35",street:"ул. Дорожная, 35",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"28"}]},mapLink:"https://yandex.ru/map-widget/v1/?um=constructor%3A9a0521a20ec9ea1315277cdb881c07a8ac38e1dbe49164611a0d8cca3276111f&amp;source=constructor"},{name:"Великий Новгород",kladr_id:"53000001000",firstLetter:"В",price:"450"},{name:"Владивосток",kladr_id:"25000001000",price:"450"},{name:"Владикавказ",kladr_id:"15000001000",price:"450"},{name:"Владимир",kladr_id:"33000001000",price:"450"},{name:"Волгоград",kladr_id:"34000001000",price:"450"},{name:"Волгодонск",kladr_id:"61000004000",price:"450"},{name:"Вологда",kladr_id:"35000001000",price:"450"},{name:"Воронеж",kladr_id:"36000001000",price:"450"},{name:"Горно-Алтайск",kladr_id:"04000001000",firstLetter:"Г",price:"450"},{name:"Грозный",kladr_id:"20000001000",price:"450"},{name:"Дзержинск",kladr_id:"52000002000",firstLetter:"Д",price:"450"},{name:"Дятьково",kladr_id:"32006001000",price:"450"},{name:"Екатеринбург",kladr_id:"66000001000",branches:{office:[{name:"Екатеринбург, Железнодорожный район (Старая сортировка) ул.Билимбаевская д.4",street:"Железнодорожный район (Старая сортировка) ул.Билимбаевская д.4",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"37"}]},mapLink:"https://yandex.ru/map-widget/v1/?um=constructor%3A35a1946a7b5be2a472fcbf066fd1289306b9a854cf69f165806d9d034c79f1ee&amp;source=constructor",firstLetter:"Е"},{name:"Елабуга",kladr_id:"16019001000",price:"450"},{name:"Златоуст",kladr_id:"74000004000",firstLetter:"З",price:"450"},{name:"Иваново",kladr_id:"37000001000",firstLetter:"И",price:"450"},{name:"Ижевск",kladr_id:"18000001000",price:"450"},{name:"Иркутск",kladr_id:"38000003000",price:"450"},{name:"Йошкар-Ола",kladr_id:"12000001000",firstLetter:"Й",price:"450"},{name:"Казань",kladr_id:"16000001000",firstLetter:"К",price:"450"},{name:"Калининград",kladr_id:"39000001000",price:"450"},{name:"Калуга",kladr_id:"40000001000",price:"450"},{name:"Кемерово",kladr_id:"42000009000",price:"450"},{name:"Киров",kladr_id:"43000004000",price:"450"},{name:"Кострома",kladr_id:"44000003000",price:"450"},{name:"Краснодар",kladr_id:"23000001000",price:"450"},{name:"Красноярск",kladr_id:"24000001000",price:"450"},{name:"Курган",kladr_id:"45000001000",price:"450"},{name:"Курск",kladr_id:"46000001000",price:"450"},{name:"Кызыл",kladr_id:"17000001000",price:"450"},{name:"Липецк",kladr_id:"48000001000",firstLetter:"Л",price:"450"},{name:"Магадан",kladr_id:"49000001000",firstLetter:"М",price:"450"},{name:"Магас",kladr_id:"06000001000",price:"450"},{name:"Магнитогорск",kladr_id:"74000009000",price:"450"},{name:"Майкоп",kladr_id:"01000001000",price:"450"},{name:"Мамадыш",kladr_id:"16021000057",price:"450"},{name:"Махачкала",kladr_id:"05000001000",price:"450"},{name:"Москва",kladr_id:"77000000000",price:"450"},{name:"Мурманск",kladr_id:"51000001000",price:"450"},{name:"Набережные Челны",kladr_id:"16000002000",firstLetter:"Н",price:"450"},{name:"Нальчик",kladr_id:"07000001000",price:"450"},{name:"Нарьян-Мар",kladr_id:"83000001000",price:"450"},{name:"Нижневартовск",kladr_id:"86000011000",branches:{office:[{name:"Нижневартовск, ул. Авиаторов д.16",street:"ул. Авиаторов д.16",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"28"}]},mapLink:""},{name:"Нижний Новгород",kladr_id:"52000001000",price:"450"},{name:"Новокузнецк",kladr_id:"42000012000",price:"450"},{name:"Новосибирск",kladr_id:"54000001000",price:"450"},{name:"Омск",kladr_id:"55000001000",firstLetter:"О",price:"450"},{name:"Оренбург",kladr_id:"56000001000",price:"450",branches:{office:[{name:"Оренбург, ул. Путейская 19",street:"ул. Путейская 19",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"28"}]},mapLink:""},{name:"Орёл",kladr_id:"57000001000",price:"450"},{name:"Пенза",kladr_id:"58000001000",firstLetter:"П",price:"450"},{name:"Пермь",kladr_id:"59000001000",price:"450"},{name:"Петрозаводск",kladr_id:"10000001000",price:"450"},{name:"Петропавловск-Камчатский",kladr_id:"41000001000",price:"450"},{name:"Псков",kladr_id:"60000001000",price:"450"},{name:"Раменское",kladr_id:"24032000028",firstLetter:"Р",price:"450"},{name:"Ростов-на-Дону",kladr_id:"61000001000",price:"450"},{name:"Рыбинск",kladr_id:"76015001000",branches:{office:[{name:"Рыбинск, ул. Танкистов 8В",street:" ул. Танкистов 8В",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"43"}]},mapLink:""},{name:"Рязань",kladr_id:"62000001000",price:"450"},{name:"Салехард",kladr_id:"89000001000",firstLetter:"С",price:"450"},{name:"Самара",kladr_id:"63000001000",price:"450"},{name:"Санкт-Петербург",kladr_id:"78000000000",price:"450"},{name:"Саранск",kladr_id:"13000001000",price:"450"},{name:"Саратов",kladr_id:"64000001000",price:"450"},{name:"Сафоново",kladr_id:"44024000153",price:"450"},{name:"Симферополь",kladr_id:"91000007000",price:"450"},{name:"Смоленск",kladr_id:"67000003000",price:"450"},{name:"Ставрополь",kladr_id:"26000001000",price:"450"},{name:"Сургут",kladr_id:"63021000044",branches:{office:[{name:"Сургут, ул. Крылова д. 61",street:"ул. Крылова д. 61",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"28"}]},mapLink:""},{name:"Сыктывкар",kladr_id:"11000001000",price:"450"},{name:"Таганрог",kladr_id:"61000011000",firstLetter:"Т",price:"450"},{name:"Тамбов",kladr_id:"68000004000",price:"450"},{name:"Тверь",kladr_id:"69000001000",price:"450"},{name:"Томск",kladr_id:"70000001000",price:"450"},{name:"Тула",kladr_id:"71000001000",price:"450"},{name:"Тюмень",kladr_id:"72000001000",price:"450"},{name:"Улан-Удэ",kladr_id:"03000001000",firstLetter:"У",price:"450"},{name:"Ульяновск",kladr_id:"73000001000",price:"450"},{name:"Уфа",kladr_id:"02000001000",price:"450"},{name:"Фряново",kladr_id:"50040000098",firstLetter:"Ф",price:"450"},{name:"Хабаровск",kladr_id:"27000001000",firstLetter:"Х",price:"450"},{name:"Ханты-Мансийск",kladr_id:"86000001000",price:"450"},{name:"Чебоксары",kladr_id:"21000001000",firstLetter:"Ч",price:"450"},{name:"Челябинск",kladr_id:"74000001000",price:"450"},{name:"Черкесск",kladr_id:"09000001000",price:"450"},{name:"Чехов",kladr_id:"50000053000",price:"450"},{name:"Чита",kladr_id:"75000001000",price:"450"},{name:"Шебекино",kladr_id:"31000003000",firstLetter:"Ш",price:"450"},{name:"Щелково",kladr_id:"69015000184",firstLetter:"Щ",price:"450"},{name:"Элиста",kladr_id:"08000001000",firstLetter:"Э",price:"450"},{name:"Южно-Сахалинск",kladr_id:"65000001000",firstLetter:"Ю",price:"450"},{name:"Якутск",kladr_id:"14000001000",firstLetter:"Я",price:"450"},{name:"Ярославль",kladr_id:"76000001000",branches:{office:[{name:"Ярославль, ул. Полушкина роща 16Л",street:"ул. Полушкина роща 16Л",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"28"},{name:"Ярославль, ул. Урицкого 47А",street:"ул. Урицкого 47А",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"41"},{name:"Ярославль, ул.Гагарина 4А",street:"ул.Гагарина 4А",schedule:"ПН-ПТ: 9:00 - 18:00",photos:[],id:"44"}],points:[{name:"Ярославль, Ленинградский просп. д. 54",street:"Ленинградский просп. д. 54",schedule:"ПН-ПТ: 10:00-20:00, СБ: 10:00–17:00",photos:[],id:"28"},{name:"Ярославль, Московский просп. д. 91",street:"Московский просп. д. 91",schedule:"ПН-ПТ: 09:00-21:00, СБ-ВС: 09:00–18:00",photos:[],id:"28"},{name:"Ярославль, ул. Чкалова д. 70",street:"ул. Чкалова д. 70",schedule:"ПН-ПТ: 10:00–20:00, СБ: 11:00–16:00",photos:[],id:"28"}]},mapLink:"https://yandex.ru/map-widget/v1/?um=constructor%3Aacbcb9cd59b569b50fcb7ed84cbe0a579a8f551b4d992fbdb6781efd00c0c49e&amp;source=constructor"},{name:"Ярцево",kladr_id:"67025000116",price:"450"}],window.h={saveAllCookie:function(e){var t=e.type,r=e.address,n=e.id,a=e.deadline,i=e.cost,o=e.city,c=["deliveryType","deliveryAddress","selfExportPointId","deliveryDeadline","deliveryCost","deliveryCity","deliveryCourier"];[t,r,n,a,i,void 0===o?"":o,e.courier].forEach(function(e,t){return null===e?void saveCookie(c[t],""):void(!e||saveCookie(c[t],e))})},checkAvailable:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return e||t},getText:function(e){return e?e.textContent:""},handleClass:function(e,t,r){return e.classList[t](r)},addClass:function(e,t){return h.handleClass(e,"add",t)},removeClass:function(e,t){return h.handleClass(e,"remove",t)},hasClass:function(e,t){return e.classList.contains(t)},escapeHtml:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})},activateButton:function(e,t){e.disabled=!1,h.handleClass(e,"remove",t)},disableButton:function(e,t){e.disabled=!0,h.handleClass(e,"add",t)},setDataSet:function(e,t,r){return e.dataset[t]=r},getDataSet:function(e,t){return e?e.dataset[t]:""},clearEl:function(e){return e.innerHTML=""},clearInput:function(e){return e.value=""},removeElement:function(e){return null},hide:function(e){return h.handleClass(e,"add","hidden")},show:function(e){return h.handleClass(e,"remove","hidden")},hideAll:function(e){return _toConsumableArray(e).forEach(h.hide)},showAll:function(e){return _toConsumableArray(e).forEach(h.show)},setText:function(e,t){return e.textContent=t},eventAdd:function(e,t,r){return e.addEventListener(t,r)},eventRemove:function(e,t,r){return e.removeEventListener(t,r)},isMatch:function(e,t){return e===t},removeListOfEvents:function(e,t){e.filter(function(e){return e[t]}).forEach(function(e){return h.eventRemove(e.element,e.ev,e.listener)})},addListOfEvents:function(e,t){e.filter(function(e){return e[t]}).forEach(function(e){return h.eventAdd(e.element,e.ev,e.listener)})},setWaitScreen:function(e){return h.show(e)},disableWaitScreen:function(e){return h.hide(e)},lowerCase:function(e){return e.toLowerCase()},checkSubString:function(e,t){return e=h.lowerCase(e),t=h.lowerCase(t),!!~e.indexOf(t)},showError:function(e){return h.show(e)},hideError:function(e){return h.hide(e)},clearStorage:function(e){return e.forEach(function(e){return localStorage.setItem(e,"")})}};var options={basketForm:document.querySelector(".basket-index-page"),waitScreen:document.querySelector(".basket__wait-screen"),reactWrapper:document.querySelector(".basket__stages")},props=_objectSpread({},options,{nextButton:options.basketForm.querySelector(".basket__react-bottom-nav-btn"),progressHeaderButtons:options.basketForm.querySelectorAll(".basket__progress-header-item"),countInputs:options.basketForm.querySelectorAll("input.center")}),basketHandler=function(e){var t={onNextButtonClick:function(){},onProgressHeaderButtonClick:function(){},onCountInputBlur:function(){}},r=function(){return r.initiate=function(){return r},r.handleEventListeners=function(e){var n=e.nextButton,a=e.basketForm,i=e.waitScreen,o=e.reactWrapper,c=e.progressHeaderButtons,l=function(){return l.createEventListeners=function(){return t.onNextButtonClick=function(){var e=function(){var e=function(){return e};return e.prototype={_then:function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},r=arguments.length,n=Array(1<r?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return t.apply(void 0,n),e.prototype},hasBasketSelectedItems:function(){return!!basketApi.getTotalSum()},preventDefault:function(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{preventDefault:function(){}}).preventDefault()},checkStatement:function(e){var t=e.condition,r=e.stateA,n=e.stateB;return t?r():n()},setWaitScreen:function(e){return h.setWaitScreen(e)},emptyFunction:function(){},showReact:function(){h.show(o),e.hideBasket(),e.renderedBasket=!1},showBasket:function(){e.hideReact(),h.show(a),e.renderedBasket=!0},hideReact:function(){return h.hide(o)},hideBasket:function(){return h.hide(a)},disableWaitScreen:function(){return h.hide(i)},alertMessage:function(e){return alert(e)},showAlertPosition:function(){return e.alertMessage(e.alertPositionMessage)}},Object.setPrototypeOf(e,e.prototype),Object.assign(e,{renderedBasket:!0,alertPositionMessage:"Пожалуйста, выберите хотя бы одну позицию"})}();return function(t){var r=e.preventDefault,n=e.checkStatement,a=e.setWaitScreen,o=e.showReact,c=e.showBasket,l=e.disableWaitScreen,u=e.renderedBasket,s=e.hasBasketSelectedItems,d=e.showAlertPosition;r(t),s()?e._then(a,i)._then(n,{condition:u,stateA:o,stateB:c})._then(l):d()}},t.onCountInputBlur=function(){return a.submit()},l},l.addListeners=function(){return h.eventAdd(n,"click",t.onNextButtonClick()),_toConsumableArray(c).forEach(function(e){return h.eventAdd(e,"click",t.onProgressHeaderButtonClick)}),l},l};return l().createEventListeners().addListeners(),r},r};r().initiate(e).handleEventListeners(e)};basketHandler(props),window.basketApi={getTotalPricesAndItems:function(){return options.basketForm.querySelector(".basket__react-bottom-info").textContent.trim().replace(/\n/gi,"").split(" ").filter(function(e){return!!e.trim()}).filter(function(e){if(!["Оформить","Удалить","выбранные","позиции","Next"].includes(e))return e}).join(" ")},getTotalSum:function(){return window.calculateTotalSum()+(+getCookie("deliveryCost")||0)},getMaxDeliveryDate:function(){var e=function(){var t,r,n=Math.max;return e.getDates=function(r){return t=_toConsumableArray(r.querySelectorAll("tbody tr")).filter(function(e){return e.querySelector("td:nth-of-type(1) input:checked")}).map(function(e){return e.querySelector("td:nth-of-type(6)").textContent}),e},e.handle=function(){return r=(r=t.map(function(e){if(function(e){return!!~e.search(/час/)}(e))return 1;if(function(e){return!!~e.search(/-/)}(e)){var t=e.split("-").map(function(e){return parseInt(e)});return n.apply(Math,_toConsumableArray(t))}return parseInt(e)})).filter(function(e){return isFinite(e)}),_.isEmpty(r)&&(r[0]=0),e},e.calculateMax=function(){return n.apply(Math,_toConsumableArray(r))+ +getCookie("deliveryDeadline")},e};return e().getDates(options.basketForm).handle().calculateMax()},returnToBasket:function(){return props.nextButton.click()},getBasketItems:function(){var e=_toConsumableArray(options.basketForm.querySelectorAll("table tbody tr")).filter(function(e){return!0===e.querySelector("input.active-price-item").checked});try{var t=[];return e.forEach(function(e){var r=_slicedToArray(e.children,6),n=r[0].firstElementChild.dataset,a=n.basketCost,i=n.basketQnt,o=r[1].firstElementChild.firstElementChild,c=o.href,l=o.textContent,u=r[2].firstChild.textContent,s=r[5].textContent;t.push({name:l.trim()+" "+u.trim(),date:s.trim(),count:+i.trim(),price:+a.trim(),link:c})}),t}catch(e){return e.message,[]}},getPositionsNumber:function(){return _toConsumableArray(options.basketForm.querySelectorAll("table tbody tr")).filter(function(e){return!0===e.querySelector("input.active-price-item").checked}).length},getDeliveryPrice:function(){var e=getCookie("deliveryCost");return e||"0"===e?+e:""},getItemsPrice:function(){return window.calculateTotalSum()},getDeliveryDeadline:function(){return+getCookie("deliveryDeadline")},getDeliveryItemDeadline:function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:window.basketApi.getDeliveryDeadline();return e=(e=function(e){return function(e){return!!~e.search(/час/)}(e)?[1]:function(e){return!!~e.search(/-/)}(e)?e.split("-").map(function(e){return parseInt(e)}):[parseInt(e)]}(t)).filter(function(e){return isFinite(e)}),_.isEmpty(e)&&(e[0]=0),e.map(function(e){return e+(r||0)})}};var prevBasketPage=sessionStorage.getItem("prevBasketPage");prevBasketPage&&props.nextButton.click();var ShiptorPointsGetter=function e(t){var r=this,n=t.usersCity,a=t.fromCity;_classCallCheck(this,e),_defineProperty(this,"_escapeHtml",function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}),_defineProperty(this,"_getData",function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.shiptor.ru/public/v1",{method:"POST",headers:{"Content-Type":"application/json"},body:t}).then(function(e){return e.json()});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()),_defineProperty(this,"getDeliveryPoints",function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e){return r._dataHandler({method:"getDeliveryPoints",params:{kladr_id:"".concat(r.usersCityKladr),cod:"0",courier:e}})},a=[],Array.isArray(t)?t.forEach(function(e){var t=n(e);a.push(r._getData(t))}):(i=n(t),a.push(r._getData(i))),e.next=5,Promise.all(a).then(function(e){return 1<e.length?e.reduce(function(e,t){return e=e.result||e||[],t=t.result||t||[],{result:[].concat(_toConsumableArray(e),_toConsumableArray(t))}}):e[0]});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()),_defineProperty(this,"getUsersCityKladr",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r._dataHandler({method:"suggestSettlement",params:{query:r.usersCity,country_code:"RU"}}),e.next=3,r._getData(t);case 3:n=e.sent;try{r.usersCityKladr=n.result[0].kladr_id}catch(e){r.usersCityKladr="00000000000"}return e.abrupt("return",n);case 6:case"end":return e.stop()}},e)}))),_defineProperty(this,"calculateShipping",_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r._dataHandler({method:"calculateShipping",params:{kladr_id:"".concat(r.usersCityKladr),kladr_id_from:"76000001000",cod:"0",length:10,width:10,height:10,weight:1,declared_cost:0}}),e.next=3,r._getData(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))),_defineProperty(this,"_dataHandler",function(e){var t=_.clone(r.cityData);return JSON.stringify(_.extend(t,e))}),this.usersCity=this._escapeHtml(n),this.fromCity=a,this.cityData={id:"JsonRpcClient.js",jsonrpc:"2.0",method:""}};window.deliveryPickup=function(){var e=function(){var e,t=[];try{e=YMaps.location.city}catch(t){e="Ярославль"}var r=getCookie("deliveryCity")||e||"Ярославль",n=window.citiesList.filter(function(e){return e.branches&&e.name===r})[0];return n&&n.branches&&Object.keys(n.branches).forEach(function(e){return t=[].concat(_toConsumableArray(t),_toConsumableArray(n.branches[e]))}),n=t[0]&&t.map(function(e){return e.name.split(", ")}),{city:_.isEmpty(n)?"К сожалению, в данном городе у нас нет филиалов :(":n.map(function(e){return e[0]}),address:_.isEmpty(n)?'Выберите Пункт доставки в разделе "Доставка"':n.map(function(e){return e[1]})}}(),t={pickupModule:document.querySelector(".delivery-pickup")};!function(e){var t=function(e){localStorage.setItem("deliveryDate","0"),localStorage.setItem("deliveryAddress","pickup: ".concat(e))},r=function(e){var t=e.pickupModule,n=e.pointsWrapper,a=e.deliveryPoints,i=e.chosenCity;return r.initiate=function(){var e=function(t,r,n,a){var i,o,c=!1;return e.checkRender=function(){return c=t.dataset.rendered,e},e.fillModule=function(){return c||(Array.isArray(n.city)?n.city.forEach(function(e,t){return r.append(function(e,t){var r=document.createElement("p");return r.classList.add("delivery-pickup__point"),r.textContent="".concat(e,", ").concat(t),r}(e,n.address[t]))}):r.append(function(e,t){var r=document.createElement("p");return r.classList.add("delivery-pickup__no-point"),r.innerHTML="".concat(e,"<br/>").concat(t),r}(n.city,n.address)),t.dataset.rendered="1"),e},e.getUserCity=function(){return i=a.textContent,e},e.setUserCity=function(){return i?o=i:(o=getCookie("deliveryCity")||YMaps.location.city||"Ярославль",h.setText(a,o)),e},e};return e(t,n,a,i).checkRender().fillModule().getUserCity().setUserCity(),r},r},n=function(e){var r,a,i,o=e.input,c=e.pointsWrapper,l=e.pickupModule,u=e.changeCity,s=function(){},d=function(){},f=function(){},p=function(){},m=[],y=l.dataset.deliveryPoint||"";return n.create=function(){return s=function(e){var t=h.escapeHtml(e.target.value),n=function(e){var t,i=function(e){return e.toLowerCase()};return n.getAllPoints=function(){return r=r||_toConsumableArray(c.querySelectorAll(".delivery-pickup__point")),n},n.inputString=function(){return 3>e.length?a?(n.filterPoints("remove"),a=!1,t=!0,n):(t=!0,n):(e=i(e),n)},n.filterPoints=function(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"add";return t?n:(_toConsumableArray(r).forEach(function(t){var r=i(t.textContent);return 0<e.length&&~r.indexOf(e)?void h.handleClass(t,"remove","hidden"):(h.handleClass(t,o,"hidden"),void(a=!0))}),n)},n};n(t).getAllPoints().inputString().filterPoints()},s=_.debounce(s,300),d=function(e){var r=function(e){var n,a,o,u=e.target,s=function(){return s.setFastExit=function(e){return n=e,s},s.setSelected=function(e){return o=e,s},s.setPrevEl=function(e){return a=e,s},s.clearSavedInfo=function(){return h.setDataSet(l,"deliveryPoint",""),localStorage.setItem("deliveryAddress",""),localStorage.setItem("deliveryDate",""),h.saveAllCookie({type:null,address:null,id:null,deadline:null,cost:null,courier:null}),s},s.clearChosenPoint=function(){return h.removeElement(i),s},s.setChosenPoint=function(){return y=u.textContent,h.setDataSet(l,"deliveryPoint",y),s},s.saveStorageInfo=function(){return t(y),h.saveAllCookie({type:"pickup",address:y,id:"",deadline:"0",cost:"0",city:y.split(",")[0]}),s},s};return r.checkEl=function(){return u.classList.contains("delivery-pickup__point")?(u.classList.contains("delivery-pickup__point--active")?s().setFastExit(!0).setSelected(!0):s().setPrevEl(c.querySelector(".delivery-pickup__point--active")),r):(s().setFastExit(!0),r)},r.saveInfo=function(){return o?(s().clearSavedInfo().clearChosenPoint(),r):(n||s().setChosenPoint().saveStorageInfo(),r)},r.setStatus=function(){return n||h.handleClass(u,"add","delivery-pickup__point--active"),o&&h.handleClass(u,"remove","delivery-pickup__point--active"),a&&h.handleClass(a,"remove","delivery-pickup__point--active"),r},r};r(e).checkEl().saveInfo().setStatus()},f=function(){var e=function(){return e.restorePoints=function(){return _toConsumableArray(c.children).forEach(function(e){return h.handleClass(e,"remove","hidden")}),e},e.hide=function(){return h.handleClass(l,"add","hidden"),e},e.inputClear=function(){return o.value="",e},e.removeListeners=function(){return m.forEach(function(e){return function(e,t,r){return e.removeEventListener(t,r)}(e[0],e[1],e[2])}),e},e.disableBlockScreen=function(){return h.handleClass(blockScreen,"add","hidden"),e},e.blockConfirmButton=function(){return e},e.callCustomEvent=function(){return l.dispatchEvent(customEvent),e},e};e().hide().restorePoints().inputClear().removeListeners().blockConfirmButton().disableBlockScreen().callCustomEvent()},function(){var e=function(){return e.closeModule=function(){return f(),e},e.saveInfo=function(){return t(y),e},e};e().saveInfo().closeModule()},p=function(){h.saveAllCookie({type:null,address:null,id:null,deadline:null,cost:null,courier:null}),sessionStorage.setItem("fromAnotherUrl","/baskets"),sessionStorage.setItem("haveToOpenPickupModule","y"),sessionStorage.setItem("prevBasketPage","2"),sessionStorage.setItem("fromPickup","y"),sessionStorage.setItem("backFromPickup","y"),location.assign("/kontakty.html")},n},n.add=function(){return(m=[[o,"input",s],[c,"click",d],[u,"click",p]]).forEach(function(e){return function(e,t,r){return e.addEventListener(t,r)}(e[0],e[1],e[2])}),n},n};r(e).initiate(),n(e).create().add()}(_.extend(t,{pointsWrapper:t.pickupModule.querySelector(".delivery-pickup__points-list"),input:t.pickupModule.querySelector(".delivery-pickup__input"),chosenCity:t.pickupModule.querySelector(".delivery-pickup__chosen-city"),changeCity:t.pickupModule.querySelector(".delivery-pickup__change-city"),deliveryPoints:e}))},window.deliverySelfExport=function(){var e={selfExportModule:document.querySelector(".delivery-selfExport"),JCShiptorWidgetPvz:document.querySelector("#shiptor_widget_pvz"),map:document.querySelector('[data-role="shiptor_widget_show"]')};!function(e){var t={onChangeCity:function(){},onShowMapClick:function(){},onPickupConfirm:function(){},onPickupInput:function(){},onPickupPointClick:function(){},onCloseClick:function(){},onMapClose:function(){}},r=function(e,t,r){localStorage.setItem("deliveryDate",h.getDataSet(e,"deliveryPeriod")),localStorage.setItem("deliveryAddress","delivery: ".concat(t," | ").concat(r))},n=function(e){var t,r,n=e.result.methods;try{t=n[0].min_days}catch(e){var a=e.message;console.log(a),t=0}try{r=n[0].max_days}catch(e){var i=e.message;console.log(i),r=0}return[t,r]},a=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"77000000000";return new ShiptorPointsGetter({usersCity:e,fromCity:t})},i=function(e){var t=e.itemList,r=e.childClassName,n=e.wrapper,a=e.fastExit,i=e.isCityFiltered,o=e.firstInitiate,c=!(void 0!==o)||o;return function(e){var o=h.escapeHtml(e.target.value),l=function(e){var o;return l.initiate=function(){return c&&(t="pickup"===t?n.querySelector(".delivery-selfExport__pickup-list"):n.querySelector(".delivery-selfExport__cities-list")),c=!1,l},l.getAllPoints=function(){return o=_toConsumableArray(t.querySelectorAll(r)),l},l.inputString=function(){return 3>e.length?i?(l.filterPoints("remove"),i=!1,a=!0,l):(a=!0,l):(e=h.lowerCase(e),l)},l.filterPoints=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"add";return a?l:(o.forEach(function(r){var n=r.dataset.value;return h.checkSubString(n,e)?void h.handleClass(r,"remove","hidden"):(h.handleClass(r,t,"hidden"),void(i=!0))}),l)},l.clearClosure=function(){return a="",l},l};l(o).initiate().getAllPoints().inputString().filterPoints().clearClosure()}},o=function(e){var t=e.selfExportModule,r=e.pickupList,i=e.chosenCity,c=e.pickupSection,l=e.pickupSearchInput,u=e.JCShiptorWidgetPvz,s=e.waitScreen,d=e.errorSection;return o.initiate=function(){var e=function(){var o,f,p,m,y=!1,v=+localStorage.getItem("needRerender");return e.showPickupSection=function(){return h.show(c),e},e.setWaitScreen=function(){return h.setWaitScreen(s),e},e.getUserCity=function(){return o=i.textContent,e},e.setUserCity=function(){return o?f=o:(f=getCookie("deliveryCity")||YMaps.location.city||"Ярославль",h.setText(i,f)),e},e.checkRender=function(){var r=function(){return r.getRenderedPoints=function(){return y=h.getDataSet(t,"renderedPoints"),r},r.getRenderedCity=function(){return o!==h.getDataSet(t,"renderedCity")&&(o=""),r},r.setRenderedCity=function(){return h.setDataSet(t,"renderedCity",f),r},r};return r().getRenderedCity().getRenderedPoints().setRenderedCity(),e},e.handleDeliveryPoints=function(){if(!y||!o||v){var i=function(){return i.clearLocalRerenderInfo=function(){return localStorage.setItem("needRerender",""),v=!1,i},i.cleaPickupInput=function(){return h.clearInput(l),i},i.clearPickupList=function(){return h.clearEl(r),i},i.initiateApi=function(){return m=a(f,"77000000000"),i},i.handleRequest=function(){m.getUsersCityKladr().then(function(e){var r;try{r=e.result[0].kladr_id}catch(e){var n=e.message;console.log(n),r="11001110011"}return h.setDataSet(t,"cityKladr",r),r}).then(function(e){return h.setDataSet(u,"cityKladr",e)}).then(function(e){return i.setKladrId(e)}).then(function(){return window.JCShiptorWidgetPvz.hide()}).then(function(){return m.calculateShipping()}).then(function(e){var r=_slicedToArray(n(e),2),a=r[0],i=r[1];[a+0,i+0],h.setDataSet(t,"deliveryPeriod",i||a)}).then(function(){m.getDeliveryPoints(["cdek","pec","dpd"]).then(function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return 1>e.result.length&&h.showError(d),i.filterPoints(e)}).then(function(){h.setDataSet(t,"renderedPoints",1),e.checkRender(),o=f}).then(function(){return e.disableWaitScreen(s)})})},i.filterPoints=function(e){var t=e.result;return p=t.filter(function(e){return e.active}),i.renderDeliveryPoints(p),i},i.renderDeliveryPoints=function(e){var t=function(e){var t=e.courier,r=e.address,n=e.prepare_address,a=e.id,i=function(e,t){var r,n,a;try{"object"===_typeof(e=e||t)?(r=e.street,n=e.house,a="".concat(r," ").concat(n)):(a=(a=t).split(", "),a="".concat(a[1]," ").concat(a[2]))}catch(t){}return a}(n,r),o=document.createElement("li");h.handleClass(o,"add","delivery-selfExport__pickup-point"),h.setDataSet(o,"value",i),h.setDataSet(o,"id",a),h.setDataSet(o,"courier",t);var c=document.createElement("p");return h.handleClass(c,"add","delivery-selfExport__address"),h.setText(c,r),o.append(c),o},n=document.createDocumentFragment();e.forEach(function(e){n.append(t(e))}),r.append(n)},i.setKladrId=function(e){return window.JCShiptorWidgetPvz.setParams({location:{kladr_id:e}}),window.JCShiptorWidgetPvz.refresh(),i},i};return i().clearLocalRerenderInfo().cleaPickupInput().clearPickupList().initiateApi().handleRequest(),e}return e.disableWaitScreen(s),e},e.disableWaitScreen=_asyncToGenerator(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.disableWaitScreen(s);case 2:return t.abrupt("return",e);case 3:case"end":return t.stop()}},t)})),e};e().showPickupSection().setWaitScreen().getUserCity().setUserCity().checkRender().handleDeliveryPoints()},o},c=function(e){var n=e.changeCity,a=e.showMap,o=e.pickupSection,l=e.citiesList,u=e.selfExportModule,s=e.citiesSection,d=e.pickupSearchInput,f=e.pickupList,p=e.JCShiptorWidgetPvz,m=e.map,y=[],v="".concat(u.dataset.renderedCity,", ").concat(u.dataset.deliveryPoint)||"",b=h.getDataSet(f.querySelector(".delivery-selfExport__pickup-point--active"),"courier"),k=new Event("ClosePickupModule",{bubbles:!0});return c.create=function(){return t.onChangeCity=function(){h.saveAllCookie({type:null,address:null,id:null,deadline:null,cost:null,courier:null}),sessionStorage.setItem("fromAnotherUrl","/baskets"),sessionStorage.setItem("prevBasketPage","2"),location.assign("/kontakty.html")},t.onPickupInput=_.partial(i,{itemList:"pickup",childClassName:".delivery-selfExport__pickup-point",wrapper:u}),t.onPickupInput=_.debounce(t.onPickupInput(),300),t.onPickupPointClick=function(e){var t=function(e){var n,a,i,o=e.target,c=function(){return c.setFastExit=function(e){return n=e,c},c.setSelected=function(e){return i=e,c},c.setPrevEl=function(e){return a=e,c},c.clearSavedInfo=function(){return h.setDataSet(u,"deliveryPoint",null),h.clearStorage(["deliveryDate","deliveryAddress"]),h.saveAllCookie({type:null,address:null,id:null,deadline:null,cost:null,courier:null}),c},c.clearChosenPoint=function(){return h.removeElement(void 0),c},c.setChosenPoint=function(){return v=o.querySelector(".delivery-selfExport__address").textContent,b=h.getDataSet(o,"courier"),h.setDataSet(u,"deliveryPoint",h.getDataSet(o,"value")),c},c.setStorageInfo=function(){return r(u,v,b),h.saveAllCookie({type:"selfExport",address:v,id:h.getDataSet(o,"id"),deadline:u.dataset.deliveryPeriod,cost:window.citiesList[0].price,courier:b}),c},c};return t.checkEl=function(){var e=h.lowerCase(o.tagName);return"li"!==e&&"p"!==e?(c().setFastExit(!0),t):("p"===e&&(o=o.parentElement),o.classList.contains("delivery-selfExport__pickup-point--active")?c().setFastExit(!0).setSelected(!0):c().setPrevEl(f.querySelector(".delivery-selfExport__pickup-point--active")),t)},t.saveInfo=function(){return i?(c().clearSavedInfo().clearChosenPoint(),t):(n||c().setChosenPoint().setStorageInfo(),t)},t.setStatus=function(){return n||h.handleClass(o,"add","delivery-selfExport__pickup-point--active"),i&&h.handleClass(o,"remove","delivery-selfExport__pickup-point--active"),a&&h.handleClass(a,"remove","delivery-selfExport__pickup-point--active"),t},t};t(e).checkEl().saveInfo().setStatus()},t.onCloseClick=function(){var e=function(){return e.restorePoints=function(){return _toConsumableArray(f.children).forEach(function(e){return h.handleClass(e,"remove","hidden")}),e},e.hide=function(){return[u,o,s].forEach(h.hide),e},e.inputClear=function(){return d.value="",e},e.showAllCities=function(){return h.showAll(l.children),e},e.removeListeners=function(){return h.removeListOfEvents(y,"closeModule"),e},e.callCustomEvent=function(){return u.dispatchEvent(k),e},e};e().hide().restorePoints().inputClear().showAllCities().removeListeners().callCustomEvent()},t.onPickupConfirm=function(){r(u,v,b),t.onCloseClick()},t.onShowMapClick=function(){var e=function(){return e.mapCall=function(){return m.click(),e},e};e().mapCall()},t.onMapClose=function(e){var r=function(){return r.handleData=function(e){var n=e.detail.address,a=function(){var e;return a.handleGettedAddress=function(){return n=h.lowerCase(n),a},a.getChosenPickupFromList=function(){return e=_toConsumableArray(f.children).filter(function(e){var t=h.lowerCase(e.querySelector(".delivery-selfExport__address").textContent);return h.isMatch(t,n)}),a},a.handleChosenPoint=function(){return e?((e=e[0]).click(),a):void alert("Автоматически пункт выдачи не найден :( \n Попробуйте самостоятельно найти в списке")},a.sortPickupList=function(){return e.remove(),f.prepend(e),a},a.clearPreviousSearch=function(){return t.onPickupInput({target:{value:""}}),a},a};return a().handleGettedAddress().getChosenPickupFromList().handleChosenPoint().sortPickupList().clearPreviousSearch(),r},r};r().handleData(e)},c},c.listInitiate=function(){return y=[{element:n,ev:"click",listener:t.onChangeCity,changeCityRemove:!0,cityConfirmAdd:!0,boot:!0},{element:a,ev:"click",listener:t.onShowMapClick,changeCityRemove:!0,cityConfirmAdd:!0,boot:!0},{element:d,ev:"input",listener:t.onPickupInput,changeCityRemove:!0,cityConfirmAdd:!0,boot:!0},{element:f,ev:"click",listener:t.onPickupPointClick,changeCityRemove:!0,cityConfirmAdd:!0,boot:!0},{element:p,ev:"onPvzSelect",listener:t.onMapClose,boot:!0}],c},c.add=function(){return h.addListOfEvents(y,"boot"),c},c};o(e).initiate(),c(e).create().listInitiate().add()}(_.extend(e,{citiesList:e.selfExportModule.querySelector(".delivery-selfExport__cities-list"),pickupList:e.selfExportModule.querySelector(".delivery-selfExport__pickup-list"),pickupSection:e.selfExportModule.querySelector(".delivery-selfExport__pickup"),citiesSection:e.selfExportModule.querySelector(".delivery-selfExport__cities"),citySearchInput:e.selfExportModule.querySelector(".delivery-selfExport__city-search-input"),pickupSearchInput:e.selfExportModule.querySelector(".delivery-selfExport__pickup-search-input"),errorSection:e.selfExportModule.querySelector(".delivery-selfExport__error"),waitScreen:e.selfExportModule.querySelector(".delivery-selfExport__wait-screen"),chosenCity:e.selfExportModule.querySelector(".delivery-selfExport__chosen-city"),changeCity:e.selfExportModule.querySelector(".delivery-selfExport__change-city"),showMap:e.selfExportModule.querySelector(".delivery-selfExport__show-map")}))},function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==_typeof(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)t.d(n,a,function(t){return e[t]}.bind(null,a));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}([function(e){e.exports=React},function(e){e.exports=ReactDOM},function(e,t,r){function n(){return(n=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}function a(e){for(var t=1;t<arguments.length;t++){var r=null==arguments[t]?{}:arguments[t],n=Object.keys(Object(r));"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){i(e,t,r[t])})}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e){for(var t=1;t<arguments.length;t++){var r=null==arguments[t]?{}:arguments[t],n=Object.keys(Object(r));"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){d(e,t,r[t])})}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e){for(var t=1;t<arguments.length;t++){var r=null==arguments[t]?{}:arguments[t],n=Object.keys(Object(r));"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){p(e,t,r[t])})}return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m(e){return function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(){return(v=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}function h(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function _(){return(_=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g(){return(g=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}function E(){return(E=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}function S(){return(S=Object.assign||function(e){for(var t,r=1;r<arguments.length;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}r.r(t);var O=r(0),x=r.n(O),P=function(e){var t=n({},e);return x.a.createElement("button",t,"Продолжить")},j=function(e){var t=function(e){return Array.isArray(e)?e.reduce(function(e,t){var r,n;return e[t]=(r=t,(n=document.cookie.match(new RegExp("(?:^|; )"+r.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)")))?decodeURIComponent(n[1]):void 0),e},{}):e},r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(Object(O.useState)(t(e)),2),n=r[0],a=r[1];return Object(O.useEffect)(function(){n&&Object.keys(n)[0]&&Object.keys(n).forEach(function(e){return n[e]&&function(e,t){var r={path:"/",secure:!0,expires:new Date(Date.now()+115864e7)},n=encodeURIComponent(e)+"="+encodeURIComponent(t);for(var a in r){n+="; "+a;var i=r[a];!0!==i&&(n+="="+i)}document.cookie=n}(e,n[e])})},[n]),[n,function(){return a(function(e){return t(Object.keys(e))})}]},A=Object(O.createContext)([{},function(){}]),I=function(e){var t=e.children,r=o(j(["deliveryAddress","deliveryType","deliveryCost","deliveryDeadline","selfExportPointId","deliveryCity"]),2),n=r[0],i=r[1],c=o(Object(O.useState)(a({},n,{pickup:{officeHeader:"Офисы обслуживания",pointHeader:"Пункты самовывоза",linkText:"Выбрать другое место самовывоза",showModule:!n.deliveryAddress&&!n.deliveryType},selfExport:{header:"Пункты доставки",linkText:"Выбрать другой пункт выдачи",showModule:!1}})),2),l=c[0],u=c[1];return x.a.createElement(A.Provider,{value:[l,function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return i(),u(function(t){return a({},t,n,e)}),l}]},t)},N=function(e){var t=c(j("string"==typeof e&&[e]||e),2),r=t[0],n=t[1],a=c(Object(O.useState)(!1),2),i=a[0],o=a[1];return Object(O.useEffect)(function(){o(r&&Object.keys(r).every(function(e){return!!r[e]}))},[r]),[i,function(){return n()}]},L=Object(O.createContext)([{},function(){}]),T=function(e){var t=e.children,r=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(N(["deliveryAddress","deliveryType","deliveryCost","deliveryDeadline"]),2),n=r[0],a=r[1];return x.a.createElement(L.Provider,{value:[n,a]},t)},D=function(e){var t=e.className,r=e.next,n=e.setNext,a=u(Object(O.useContext)(L),2)[1],i=u(Object(O.useContext)(A),2),o=i[0].pickup,c=i[1];return Object(O.useEffect)(function(){window.deliveryPickup()},[]),x.a.createElement("div",{className:"delivery-pickup ".concat(t||""),"data-delivery-type":"Самовывоз"},x.a.createElement("div",{className:"delivery-pickup__chosen-city-wrapper"},x.a.createElement("p",{className:"delivery-pickup__chosen-city-descr"},"Текущий город: "),x.a.createElement("p",{className:"delivery-pickup__chosen-city"}),x.a.createElement("button",{className:"delivery-pickup__change-city"},"Выбрать другой город")),x.a.createElement("input",{type:"text",className:"delivery-pickup__input",placeholder:"Введите улицу"}),x.a.createElement("header",{className:"delivery-pickup__points-header"},o.officeHeader),x.a.createElement("div",{className:"delivery-pickup__points-list",onClick:function(e){var t=e.target;a(),c(),t.classList.contains("delivery-pickup__point--active")?n(!0):n(!1)}}),r&&x.a.createElement(P,{onClick:function(){var e=o.showModule;c({pickup:function(e){for(var t=1;t<arguments.length;t++){var r=null==arguments[t]?{}:arguments[t],n=Object.keys(Object(r));"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){l(e,t,r[t])})}return e}({},o,{showModule:!e})})},className:"delivery-pickup__continue-btn"}))},M=function(e){var t=e.deliveryType,r=e.setNext,n=e.next,a=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(Object(O.useContext)(A),2),i=a[0],o=a[1],c=i[t],l=i.deliveryAddress,u=c.showModule,f=c.linkText;return Object(O.useEffect)(function(){var e=!l&&sessionStorage.getItem("haveToOpenPickupModule");e&&sessionStorage.removeItem("haveToOpenPickupModule"),o(d({},t,s({},c,{showModule:e?!u:u})))},[n]),x.a.createElement(x.a.Fragment,null,x.a.createElement("div",{className:"basket__react-delivery-choose-point"},"Текущий пункт выдачи: ",x.a.createElement("strong",{className:"basket__react-delivery-strong"},t===i.deliveryType?i.deliveryAddress:"не выбран")),x.a.createElement("button",{onClick:function(){r(!1),o(d({},t,s({},c,{showModule:!u})))},className:"basket__react-delivery-choose-pickAnotherPoint"},f))},q=function(e){var t=e.text,r=e.className;return x.a.createElement("div",{className:"basket__react-additional-info-item basket__react-additional-info-item--"+r},t)},R=function(){var e=y(Object(O.useState)({header:"",name:"",phone:"",schedule:"",mapLink:""}),2),t=e[0],r=e[1],n=y(Object(O.useContext)(A),1)[0],a=n.deliveryType,i=n.deliveryCity,o=n.deliveryAddress;Object(O.useEffect)(function(){var e,t,n;try{"pickup"===a?function(){var e=window.citiesList.filter(function(e){return e.name===i})[0],t=e.mapLink,n=void 0===t?"":t,a=[];e&&e.branches&&Object.keys(e.branches).forEach(function(t){return a=[].concat(m(a),m(e.branches[t]))}),a=f({},a.filter(function(e){return e.name===o})[0]),r(f({},a,{header:"Контактная информация",mapLink:n}))}():(e=getCookie("deliveryCity"),t=+getCookie("selfExportPointId"),(n=new ShiptorPointsGetter({usersCity:e,fromCity:"_"})).getUsersCityKladr().then(function(){n.getDeliveryPoints().then(function(e){var n=e.result.filter(function(e){return e.id===t});try{var a=y(n,1)[0],i=a.address,o=a.phones,c=void 0===o?[]:o,l=a.work_schedule;r({header:"Контактная информация",name:i,phone:c[0]&&c.reduce(function(e,t){return"".concat(e," + /n + ").concat(t)}),schedule:l,mapLink:""})}catch(e){var u=e.message;console.log(u)}})}))}catch(e){var c=e.message;console.log(c)}},[]);var c=t.header,l=void 0===c?"":c,u=t.name,s=void 0===u?"":u,d=t.phone,p=void 0===d?"":d,v=t.schedule,h=void 0===v?"":v,b=t.mapLink,_=void 0===b?"":b;return(l&&s||_)&&x.a.createElement("section",{className:"basket__react-additional-info"},x.a.createElement("header",{className:"basket__react-additional-info-header"},l),x.a.createElement("div",{className:"basket__react-additional-info-body"},x.a.createElement("div",{className:"basket__react-additional-info-left-part"},function(){var e={name:s,phone:p,schedule:h};return Object.keys(e).map(function(t){return e[t]&&x.a.createElement(q,{text:e[t],className:t})})}()),x.a.createElement("div",{className:"basket__react-additional-info-right-part"},_&&x.a.createElement("iframe",{src:_,width:"100%",height:"100%",frameBorder:"0"}))))},B=function(e){var t=e.deliveryType,r=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,["deliveryType"]),n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(Object(O.useContext)(A),1)[0],a=n.deliveryType,i=n.pickup.showModule;return x.a.createElement(x.a.Fragment,null,x.a.createElement(M,v({deliveryType:t},r)),i?x.a.createElement(D,r):t===a&&x.a.createElement(R,null))},F=function(e){var t=e.className,r=e.next,n=e.setNext,a=b(Object(O.useContext)(L),2)[1],i=b(Object(O.useContext)(A),2),o=i[0].selfExport,c=i[1];return Object(O.useEffect)(function(){window.deliverySelfExport()},[]),x.a.createElement(x.a.Fragment,null,x.a.createElement("div",{className:"delivery-selfExport ".concat(t),"data-delivery-type":"Пункт выдачи"},x.a.createElement("div",{className:"delivery-selfExport__wait-screen hidden preloader-mini"},x.a.createElement("div",{className:"preloader-mini__item"},x.a.createElement("div",{className:"preloader-mini__item-tool"}),x.a.createElement("div",{className:"preloader-mini__item-tool"}),x.a.createElement("div",{className:"preloader-mini__item-tool"}),x.a.createElement("div",{className:"preloader-mini__item-tool"}))),x.a.createElement("div",{className:"delivery-selfExport__chosen-city-wrapper"},x.a.createElement("p",{className:"delivery-selfExport__chosen-city-descr"},"Текущий город: "),x.a.createElement("p",{className:"delivery-selfExport__chosen-city"}),x.a.createElement("button",{className:"delivery-selfExport__change-city"},"Выбрать другой город")),x.a.createElement("section",{className:"delivery-selfExport__pickup"},x.a.createElement("header",{className:"delivery-selfExport__pickup-header"},x.a.createElement("p",{className:"delivery-selfExport__pickup-header-text"},"Пункты выдачи"),x.a.createElement("button",{className:"delivery-selfExport__show-map"},"Посмотреть на карте")),x.a.createElement("input",{type:"text",className:"delivery-selfExport__pickup-search-input",placeholder:"Поиск пункта выдачи"}),x.a.createElement("ul",{onClick:function(e){var t=e.target;a(),c(),t.classList.contains("delivery-selfExport__pickup-point--active")||t.parentElement.classList.contains("delivery-selfExport__pickup-point--active")?n(!0):n(!1)},className:"delivery-selfExport__pickup-list"}),r&&x.a.createElement(P,{onClick:function(){var e=o.showModule;c({selfExport:function(e){for(var t=1;t<arguments.length;t++){var r=null==arguments[t]?{}:arguments[t],n=Object.keys(Object(r));"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){h(e,t,r[t])})}return e}({},o,{showModule:!e})})},className:"delivery-pickup__continue-btn"})),x.a.createElement("section",{className:"delivery-selfExport__error hidden"},x.a.createElement("p",{className:"delivery-selfExport__error-text"},"К сожалению пункты выдачи не найдены :(",x.a.createElement("br",null),"Попробуйте сменить город"))))},W=function(e){var t=e.deliveryType,r=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,["deliveryType"]),n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(Object(O.useContext)(A),1)[0],a=n.deliveryType,i=n.selfExport.showModule;return x.a.createElement(x.a.Fragment,null,x.a.createElement(M,_({deliveryType:t},r)),i?x.a.createElement(F,r):t===a&&x.a.createElement(R,null))},H=function(e){var t=e.onTabClick,r=e.deliveryType,n="pickup"===r,a=function(e){for(var t=1;t<arguments.length;t++){var r=null==arguments[t]?{}:arguments[t],n=Object.keys(Object(r));"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){k(e,t,r[t])})}return e}({deliveryType:r},function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,["onTabClick","deliveryType"])),i="basket__progress-header-item basket__progress-header-item--without-before ".concat(n&&"basket__progress-header-item--active"),o="basket__progress-header-item basket__progress-header-item--without-before ".concat(!n&&"basket__progress-header-item--active");return x.a.createElement(x.a.Fragment,null,x.a.createElement("ul",{className:"basket__tabs-wrapper"},x.a.createElement("li",{className:i,onClick:function(){return t("pickup")}},"Самовывоз"),x.a.createElement("li",{className:o,onClick:function(){return t("selfExport")}},"Доставка")),n?x.a.createElement(B,a):x.a.createElement(W,a))},U=function(e){var t=e.header;return x.a.createElement("header",{className:"basket__react-stage-header"},t)},G=function(e){var t=e.header,r=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,["header"]);return x.a.createElement(x.a.Fragment,null,x.a.createElement(U,{header:t}),x.a.createElement(H,r))},K=function(e){var t=e.name,r=(e.date,e.count),n=e.price,a=e.link;return x.a.createElement("li",{className:"basket__react-final-goods-item"},x.a.createElement("a",{href:a,className:"basket__react-final-goods-item-link"},x.a.createElement("p",{className:"basket__react-final-goods-item-name"},t)),x.a.createElement("p",{className:"basket__react-final-goods-item-count"},r," шт."),x.a.createElement("p",{className:"basket__react-final-goods-item-price"},n*r," р."))},z=function(){var e=window.basketApi.getBasketItems();return x.a.createElement("ul",{className:"basket__react-final-goods-item-list"},e.map(function(e){return x.a.createElement(K,e)}))},J=function(){var e=parseInt(window.basketApi.getTotalPricesAndItems().replace("Итого ","")),t=window.basketApi.getItemsPrice();return x.a.createElement("header",{className:"basket__react-final-goods-header"},x.a.createElement("p",{className:"basket__react-final-goods-header-positions"},function(e){switch(!0){case"1"===e.toString().slice(-1):return"".concat(e," позиция");case 1<+e.toString().slice(-1)&&5>+e.toString().slice(-1):return"".concat(e," позиции");default:return"".concat(e," позиций")}}(e),x.a.createElement("button",{className:"basket__react-final-goods-open-button",onClick:function(e){var t=e.target,r=document.querySelector(".basket__react-final-goods-item-list"),n=r.style.display;"none"!==n&&n?($(r).slideUp(),t.classList.remove("basket__react-final-goods-open-button--open")):($(r).slideDown(),t.classList.add("basket__react-final-goods-open-button--open"))}},"Открыть")),x.a.createElement("p",{className:"basket__react-final-goods-header-price"},t," р."))},Y=function(){return x.a.createElement("div",{className:"basket__react-final-goods"},x.a.createElement(J,null),x.a.createElement(z,null))},Q=function(){var e,t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(Object(O.useContext)(A),1)[0].deliveryType;return x.a.createElement("header",{className:"basket__react-final-delivery-header"},x.a.createElement("p",{className:"basket__react-final-delivery-price-text"},"pickup"===t?"Самовывоз":"Доставка"),x.a.createElement("p",{className:"basket__react-final-delivery-price"},(e=getCookie("deliveryCost")||0,"".concat(e," р."))))},V=function(){var e=window.basketApi.getMaxDeliveryDate();return x.a.createElement("div",{className:"basket__react-final-delivery-deadline"},x.a.createElement("p",{className:"basket__react-final-delivery-deadline-text"},"Срок доставки"),x.a.createElement("p",{className:"basket__react-final-delivery-deadline-days"},e," дн."))},X=function(){return x.a.createElement("div",{className:"basket__react-final-delivery-body"},x.a.createElement("div",{className:"basket__react-final-delivery-address-wrapper"},x.a.createElement("p",{className:"basket__react-final-delivery-address"},getCookie("deliveryAddress")||"")),x.a.createElement(V,null))},Z=function(){return x.a.createElement("div",{className:"basket__react-final-delivery"},x.a.createElement(Q,null),x.a.createElement(X,null))},ee=function(){return x.a.createElement("div",{className:"basket__react-final-body"},x.a.createElement(Y,null),x.a.createElement(Z,null))},te=function(){return x.a.createElement(ee,null)},re=function(){return x.a.createElement(te,null)},ne=function(e){var t=e.text,r=e.available,n=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,["text","available"]);return x.a.createElement("button",g({},n,{disabled:!r}),x.a.createElement("span",{className:"basket__react-bottom-nav-btn-text"},t),x.a.createElement("span",{className:"basket__react-bottom-nav-btn-arrow"}))},ae=function(e){var t,r=e.step,n=e.onClick,a=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(Object(O.useContext)(L),1)[0];return x.a.createElement("div",{className:"basket__react-bottom-nav"},(t={2:{text:["К корзине","Далее"],className:["basket__react-bottom-nav-btn","basket__react-bottom-nav-btn"],onClick:[window.basketApi.returnToBasket,n.bind(null,"add")],available:[!0,a]},3:{text:["Назад","Оформить"],className:["basket__react-bottom-nav-btn","basket__react-bottom-nav-btn basket__react-bottom-nav-btn--confirm"],onClick:[n.bind(null,"sub"),function(e){e.preventDefault(),document.querySelector("a.c-order.to-right").click()}],available:[!0,a]}},[,,].fill("").map(function(e,n){var a=t[r],i=a.text,o=a.className,c=a.onClick,l=a.available;return x.a.createElement(ne,{key:n,text:i[n],className:o[n],onClick:c[n],available:l[n]})})))},ie=function(e){var t,r,n=e.next,a=e.step,i=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(j(["deliveryCost"]),2),o=i[0].deliveryCost,c=i[1];return Object(O.useEffect)(function(){return c()},[n]),x.a.createElement("div",{className:"basket__react-bottom-info"},(t=window.basketApi.getTotalPricesAndItems(),r=o?"".concat(o," р"):"не выбран пункт выдачи",[{text:t.split(":")[0],value:t.split(":")[1],className:"basket__react-bottom-info-item basket__react-bottom-info-item--products",step:[2]},{text:"Стоимость доставки",value:r,className:"basket__react-bottom-info-item basket__react-bottom-info-item--delivery",step:[2]},{text:"Сумма к оплате",value:" ".concat(window.basketApi.getTotalSum().toLocaleString()," р."),className:"basket__react-bottom-info-item basket__react-bottom-info-item--common",step:[3]}].filter(function(e){return e.step.includes(a)}).map(function(e,t){var r=e.text,n=e.value,a=e.className;return x.a.createElement("div",{key:t,className:a},r,": ",x.a.createElement("span",{className:"basket__react-bottom-info-item-mark"},n))})))},oe=function(){return x.a.createElement("div",{className:"basket__react-bottom-message"},x.a.createElement("p",{className:"basket__react-bottom-message-text"},"Обращаем Ваше внимание, что стоимость доставки предварительная. Окончательная стоимость доставки будет рассчитана менеджером, исходя из веса и объема заказанных товаров."))},ce=function(e){var t=E({},e);return x.a.createElement(x.a.Fragment,null,x.a.createElement("section",{className:"basket__react-bottom-panel"},x.a.createElement(ie,t),x.a.createElement(ae,t)),x.a.createElement(oe,null))},le=function(e){var t=e.text,r=e.className,n=e.onClick;return x.a.createElement("li",{onClick:n,className:r.join(" ")},t)},ue=function(e){var t,r=e.header,n=e.onClick,a=(e.setStep,function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,["header","onClick","setStep"])),i=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r,n=[],a=!0,i=!1;try{for(var o,c=e[Symbol.iterator]();!(a=(o=c.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(a){i=!0,r=a}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(Object(O.useContext)(L),1)[0];return x.a.createElement("ul",{className:"basket__progress-header"},(t=r,["Корзина","Способ доставки","Подтверждение заказа"].map(function(e,r){var o,c=window.innerWidth,l=function(e){for(var t=1;t<arguments.length;t++){var r=null==arguments[t]?{}:arguments[t],n=Object.keys(Object(r));"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){C(e,t,r[t])})}return e}({},a,{text:450<c?e:r+1,className:(o=["basket__progress-header-item"],t===e&&o.push("basket__progress-header-item--active"),o),onClick:function(e){return 0===e?(n.bind(null,"sub")(),window.basketApi.returnToBasket()):1===e?n.bind(null,"sub")():2===e?i?n.bind(null,"add")():function(){}:void 0}.bind(null,r)});return x.a.createElement(le,S({key:r},l))})))},se=r(1);r.n(se).a.render(x.a.createElement(function(){var e,t={2:"Способ доставки",3:"Подтверждение заказа"},r=w(Object(O.useState)(!1),2),n=r[0],a=r[1],i=w(j(["deliveryType"]),1)[0].deliveryType,o=w(Object(O.useState)(i||"pickup"),2),c=o[0],l=o[1],u=w(Object(O.useState)((e=sessionStorage.getItem("prevBasketPage"),sessionStorage.removeItem("prevBasketPage"),e&&+e||2)),2),s=u[0],d=u[1],f=function(e,t){var r="add"===e?t+1:t-1;return 4>r&&1<r?r:t},p=2===s?x.a.createElement(G,{header:t[s],onTabClick:function(e){return l(e)},deliveryType:c,next:n,setNext:a}):x.a.createElement(re,null);return x.a.createElement(I,null,x.a.createElement(T,null,x.a.createElement(ue,{setStep:d,header:t[s],onClick:function(e){return d(function(t){return f(e,t)})}}),p,x.a.createElement(ce,{onClick:function(e){return d(function(t){return f(e,t)})},step:s,next:n})))},null),document.querySelector(".basket__stages"))}]);