!function(e){var t={};function a(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=2)}([function(e,t){e.exports=React},function(e,t){e.exports=ReactDOM},function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r);var l=({...e})=>n.a.createElement("button",e,"Продолжить");const s=({className:e,setButtonState:t,onPickAnotherPointClick:a,deliveryProps:s})=>{const[c,i]=Object(r.useState)(!1);return Object(r.useEffect)(()=>{window.deliveryPickup()},[]),n.a.createElement("div",{className:`delivery-pickup ${e||""}`,"data-delivery-type":"Самовывоз"},n.a.createElement("input",{type:"text",className:"delivery-pickup__input",placeholder:"Введите город"}),n.a.createElement("div",{className:"delivery-pickup__points-list",onClick:({target:e})=>{e.classList.contains("delivery-pickup__point--active")?i(!0):i(!1)}}),c&&n.a.createElement(l,{onClick:()=>{t(!0);const{showModule:e}=s;a({...s,showModule:!e})}}))};var c=e=>{const t={};e.forEach(e=>{t[e]=(e=>{const t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0})(e)});const[a,n]=Object(r.useState)(t);return[a,(e={})=>n(t=>(Object.keys(e)[0]&&Object.keys(e).forEach(t=>((e,t)=>{const a={path:"/",secure:!0,"max-age":new Date(Date.now()+864e7)};let r=encodeURIComponent(e)+"="+encodeURIComponent(t);for(const e in a){r+="; "+e;const t=a[e];!0!==t&&(r+="="+t)}document.cookie=r})(t,e[t])),{...t,...e}))]};const i=({showPoint:e,deliveryProps:t,onPickAnotherPointClick:a,setButtonState:r})=>{const{header:l,linkText:s,showModule:i}=t,o=getCookie("deliveryAddress"),[,m]=c([]);return n.a.createElement(n.a.Fragment,null,n.a.createElement("header",{className:"basket__react-delivery-choose-header"},l),!i&&n.a.createElement("div",{className:"basket__react-delivery-choose-point"},"Текущий пункт выдачи: ",n.a.createElement("strong",{className:"basket__react-delivery-strong"},o&&e?o:"не выбран")),n.a.createElement("button",{onClick:()=>{a({...t,showModule:!i}),!i&&m({deliveryType:"",deliveryAddress:"",deliveryCost:"",SelfExportPointId:"",deliveryDeadline:""}),r(!1)},className:"basket__react-delivery-choose-pickAnotherPoint"},s))},o=({text:e,className:t})=>n.a.createElement("div",{className:"basket__react-additional-info-item basket__react-additional-info-item--"+t},e),m=()=>{const[e,t]=Object(r.useState)({header:"",name:"",phone:"",schedule:"",mapLink:""});Object(r.useEffect)(()=>{const e=getCookie("deliveryType");try{"pickup"===e?(()=>{const e=getCookie("deliveryCity"),a=getCookie("deliveryAddress"),r=window.citiesList.filter(({name:t})=>t===e)[0],{mapLink:n=""}=r,l={...r.branches.filter(({name:e})=>e===a)[0]};t({...l,header:"Контактная информация",mapLink:n})})():((e,a)=>{const r=new ShiptorPointsGetter({usersCity:e,fromCity:"_"});r.getUsersCityKladr().then(()=>{r.getDeliveryPoints().then(({result:e})=>{const r=e.filter(e=>e.id===a);try{const[{address:e,phones:a=[],work_schedule:n}]=r;t({header:"Контактная информация",name:e,phone:a[0]&&a.reduce((e,t)=>`${e} + /n + ${t}`),schedule:n,mapLink:""})}catch({message:e}){console.log(e)}})})})(getCookie("deliveryCity"),+getCookie("selfExportPointId"))}catch({message:e}){console.log(e)}},[]);const{header:a="",name:l="",phone:s="",schedule:c="",mapLink:i=""}=e;return(a&&l||i)&&n.a.createElement("section",{className:"basket__react-additional-info"},n.a.createElement("header",{className:"basket__react-additional-info-header"},a),n.a.createElement("div",{className:"basket__react-additional-info-body"},n.a.createElement("div",{className:"basket__react-additional-info-left-part"},(()=>{const e={name:l,phone:s,schedule:c};return Object.keys(e).map(t=>e[t]&&n.a.createElement(o,{text:e[t],className:t}))})()),n.a.createElement("div",{className:"basket__react-additional-info-right-part"},i&&n.a.createElement("iframe",{src:i,width:"100%",height:"100%",frameBorder:"0"}))))};function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const p=({deliveryType:e,...t})=>{const{deliveryProps:{showModule:a}}=t,r=e===getCookie("deliveryType");return n.a.createElement(n.a.Fragment,null,n.a.createElement(i,d({showPoint:r},t)),a?n.a.createElement(s,t):r&&n.a.createElement(m,null))};var u=e=>{const[t,a]=Object(r.useState)(e);return[t,e=>{a(e&&e.classList.contains("delivery-selfExport__pickup-point")?!!e.classList.contains("delivery-selfExport__pickup-point--active"):!!e.parentElement.classList.contains("delivery-selfExport__pickup-point--active"))}]};const _=({className:e,setButtonState:t,onPickAnotherPointClick:a,deliveryProps:s})=>{const c=Object(r.useRef)(null),[i,o]=Object(r.useState)(!1),[m,d]=u(!1);return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:`delivery-selfExport ${e}`,"data-delivery-type":"Пункт выдачи"},n.a.createElement("div",{className:"delivery-selfExport__wait-screen hidden preloader-mini"},n.a.createElement("div",{className:"preloader-mini__item"},n.a.createElement("div",{className:"preloader-mini__item-tool"}),n.a.createElement("div",{className:"preloader-mini__item-tool"}),n.a.createElement("div",{className:"preloader-mini__item-tool"}),n.a.createElement("div",{className:"preloader-mini__item-tool"}))),n.a.createElement("div",{className:"delivery-selfExport__chosen-city-wrapper"},n.a.createElement("p",{className:"delivery-selfExport__chosen-city-descr"},"Текущий город: "),n.a.createElement("p",{className:"delivery-selfExport__chosen-city"}),n.a.createElement("button",{className:"delivery-selfExport__change-city"},"Выбрать другой город")),n.a.createElement("section",{className:"delivery-selfExport__pickup"},n.a.createElement("header",{className:"delivery-selfExport__pickup-header"},n.a.createElement("p",{className:"delivery-selfExport__pickup-header-text"},"Пункты выдачи"),n.a.createElement("button",{className:"delivery-selfExport__show-map"},"Посмотреть на карте")),n.a.createElement("input",{type:"text",className:"delivery-selfExport__pickup-search-input",placeholder:"Поиск пункта выдачи"}),n.a.createElement("ul",{onClick:({target:e})=>{console.log(c.current.children[0]),c.current.children[0]||window.deliverySelfExport(),d(e),console.log(m),e.classList.contains("delivery-pickup__point--active")?o(!0):o(!1)},className:"delivery-selfExport__pickup-list",ref:c}),i&&n.a.createElement(l,{onClick:()=>{t(!0);const{showModule:e}=s;a({...s,showModule:!e})}})),n.a.createElement("section",{className:"delivery-selfExport__error hidden"},n.a.createElement("p",{className:"delivery-selfExport__error-text"},"К сожалению пункты выдачи не найдены :(",n.a.createElement("br",null),"Попробуйте сменить город"))))};function k(){return(k=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const b=({deliveryType:e,...t})=>{const{deliveryProps:{showModule:a}}=t,r=e===getCookie("deliveryType");return n.a.createElement(n.a.Fragment,null,n.a.createElement(i,k({showPoint:r},t)),a?n.a.createElement(_,t):r&&n.a.createElement(m,null))},v=({onTabClick:e,deliveryType:t,...a})=>{const l={pickup:{header:"Офисы обслуживания",point:getCookie("deliveryAddress"),linkText:"Выбрать другое место самовывоза",showModule:!1},selfExport:{header:"Офисы самовывоза",point:getCookie("deliveryAddress"),linkText:"Выбрать другой пункт выдачи",showModule:!1}},[s,c]=Object(r.useState)(l[t]),i="pickup"===t,o={deliveryProps:s,onPickAnotherPointClick:c,deliveryType:t,...a},m=t=>{e(t),c(l[t])},d=`basket__progress-header-item basket__progress-header-item--without-before ${i&&"basket__progress-header-item--active"}`,u=`basket__progress-header-item basket__progress-header-item--without-before ${!i&&"basket__progress-header-item--active"}`;return n.a.createElement(n.a.Fragment,null,n.a.createElement("ul",{className:"basket__tabs-wrapper"},n.a.createElement("li",{className:d,onClick:()=>m("pickup")},"Самовывоз"),n.a.createElement("li",{className:u,onClick:()=>m("selfExport")},"Доставка")),i?n.a.createElement(p,o):n.a.createElement(b,o))},E=({header:e})=>n.a.createElement("header",{className:"basket__react-stage-header"},e),y=({header:e,...t})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(E,{header:e}),n.a.createElement(v,t)),f=({name:e,date:t,count:a,price:r,link:l})=>{const[s,c]=window.basketApi.getDeliveryItemDeadline(t);return n.a.createElement("li",{className:"basket__react-final-goods-item"},n.a.createElement("a",{href:l,className:"basket__react-final-goods-item-link"},n.a.createElement("p",{className:"basket__react-final-goods-item-name"},e)),n.a.createElement("p",{className:"basket__react-final-goods-item-date"},`${s}${c?" - "+c:""}`+" дн."),n.a.createElement("p",{className:"basket__react-final-goods-item-count"},a," шт."),n.a.createElement("p",{className:"basket__react-final-goods-item-price"},r*a," р."))},h=()=>{const e=window.basketApi.getBasketItems(),t=Object(r.useRef)(null);return n.a.createElement(n.a.Fragment,null,n.a.createElement("ul",{className:"basket__react-final-goods-item-list",ref:t},e.map(e=>n.a.createElement(f,e))),n.a.createElement("button",{onClick:({target:e})=>{const{current:{style:{display:a}}}=t;"none"!==a&&a?($(t.current).slideUp(),e.textContent="Открыть"):($(t.current).slideDown(),e.textContent="Закрыть")}},"Открыть"))},g=()=>{const e=parseInt(window.basketApi.getTotalPricesAndItems().replace("Итого ","")),t=window.basketApi.getItemsPrice();return n.a.createElement("header",{className:"basket__react-final-goods-header"},n.a.createElement("p",{className:"basket__react-final-goods-header-positions"},(e=>{switch(!0){case"1"===e.toString().slice(-1):return`${e} позиция`;case+e.toString().slice(-1)>1&&+e.toString().slice(-1)<5:return`${e} позиции`;default:return`${e} позиций`}})(e)),n.a.createElement("p",{className:"basket__react-final-goods-header-price"},"На сумму ",t," р."))},N=()=>n.a.createElement("div",{className:"basket__react-final-goods"},n.a.createElement(g,null),n.a.createElement(h,null)),w=()=>{return n.a.createElement("header",{className:"basket__react-final-delivery-header"},n.a.createElement("p",{className:"basket__react-final-delivery-header-type"},"pickup"===getCookie("deliveryType")?"Самовывоз":"Пункт выдачи"),n.a.createElement("p",{className:"basket__react-final-delivery-header-price"},`${getCookie("deliveryCost")||0} р.`))},x=()=>{return n.a.createElement("div",{className:"basket__react-final-delivery-body"},n.a.createElement("p",{className:"basket__react-final-delivery-address-text"},"Адрес:"),n.a.createElement("p",{className:"basket__react-final-delivery-address"},getCookie("deliveryAddress")||""))},C=()=>n.a.createElement("div",{className:"basket__react-final-delivery"},n.a.createElement(w,null),n.a.createElement(x,null)),O=()=>{const e=window.basketApi.getMaxDeliveryDate();return n.a.createElement("div",{className:"basket__react-final-delivery-deadline"},n.a.createElement("p",{className:"basket__react-final-delivery-deadline-text"},"Срок доставки"),n.a.createElement("p",{className:"basket__react-final-delivery-deadline-days"},e," дн."))},P=()=>{const e=window.basketApi.getTotalSum();return n.a.createElement("div",{className:"basket__react-final-sum"},n.a.createElement("div",{className:"basket__react-final-message"},"Итого:"),n.a.createElement("div",{className:"basket__react-final-price"},e," р."))},j=()=>n.a.createElement("div",{className:"basket__react-final-body"},n.a.createElement(N,null),n.a.createElement(C,null),n.a.createElement(O,null),n.a.createElement(P,null)),S=()=>n.a.createElement(j,null),A=()=>n.a.createElement(S,null);function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const M=({text:e,available:t,...a})=>n.a.createElement("button",T({},a,{disabled:!t}),n.a.createElement("span",{className:"basket__react-bottom-nav-btn-text"},e),n.a.createElement("span",{className:"basket__react-bottom-nav-btn-arrow"})),D=({step:e,onClick:t,buttonAvailable:a,setButtonState:l})=>{Object(r.useEffect)(()=>{const e=[getCookie("deliveryAddress"),getCookie("deliveryDeadline"),getCookie("deliveryCost"),getCookie("deliveryType")].every(e=>!!e);l(e)},[]);return n.a.createElement("div",{className:"basket__react-bottom-nav"},(()=>{const r={2:{text:["Back To Basket","Next"],className:"basket__react-bottom-nav-btn",onClick:[window.basketApi.returnToBasket,t.bind(null,"add")],available:[!0,a]},3:{text:["Prev","Оформить"],className:"basket__react-bottom-nav-btn",onClick:[t.bind(null,"sub"),e=>e.preventDefault()],available:[!0,a]}};return new Array(2).fill("").map((t,a)=>{const{text:l,className:s,onClick:c,available:i}=r[e];return n.a.createElement(M,{key:a,text:l[a],className:s,onClick:c[a],available:i[a]})})})())},B=()=>{return n.a.createElement("div",{className:"basket__react-bottom-info"},(()=>{const e=window.basketApi.getTotalPricesAndItems();return[{text:e.split(":")[0],value:e.split(":")[1],className:"basket__react-bottom-info-item basket__react-bottom-info-item--products"},{text:"Стоимость доставки",value:`${window.basketApi.getDeliveryPrice()} р`,className:"basket__react-bottom-info-item basket__react-bottom-info-item--delivery"}].map(({text:e,value:t,className:a},r)=>n.a.createElement("div",{key:r,className:a},e,": ",n.a.createElement("span",{className:"basket__react-bottom-info-item-mark"},t)))})())},I=()=>n.a.createElement("div",{className:"basket__react-bottom-message"},n.a.createElement("p",{className:"basket__react-bottom-message-text"},"Обращаем Ваше внимание, что окончательная стоимость и состав заказа, если в нём присутствуют товары и/или услуги, участвующие в акции, будут подтверждены после обработки заказа.")),L=({...e})=>n.a.createElement(n.a.Fragment,null,n.a.createElement("section",{className:"basket__react-bottom-panel"},n.a.createElement(B,null),n.a.createElement(D,e)),n.a.createElement(I,null)),F=({text:e,className:t,onClick:a})=>n.a.createElement("li",{onClick:a,className:t.join(" ")},e);function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const U=({header:e,onClick:t,...a})=>{const r=["Корзина","Способ доставки","Подтверждение заказа"];return n.a.createElement("ul",{className:"basket__progress-header"},(e=>r.map((r,l)=>{const s=window.innerWidth,c={...a,text:s>450?r:l+1,className:(()=>{const t=["basket__progress-header-item"];return e===r&&t.push("basket__progress-header-item--active"),t})(),onClick:(e=>0===e?window.basketApi.returnToBasket:1===e?t.bind(null,"sub"):2===e?t.bind(null,"add"):void 0)(l)};return n.a.createElement(F,R({key:l},c))}))(e))};var q=a(1);a.n(q).a.render(n.a.createElement(()=>{Object(r.useEffect)(()=>{const e=getCookie("setStage");saveCookie("setStage",""),e&&i(o(e,c))},[]);const e={2:"Способ доставки",3:"Подтверждение заказа"},[t,a]=Object(r.useState)(!1),[l,s]=Object(r.useState)(getCookie("deliveryType")||"pickup"),[c,i]=Object(r.useState)(2),o=(e,t)=>{const a="add"===e?t+1:t-1;return a<4&&a>1?a:t},m=2===c?n.a.createElement(y,{header:e[c],onTabClick:e=>s(e),deliveryType:l,setButtonState:a}):n.a.createElement(A,null);return n.a.createElement(n.a.Fragment,null,n.a.createElement(U,{header:e[c],onClick:e=>i(t=>o(e,t))}),m,n.a.createElement(L,{onClick:e=>i(t=>o(e,t)),step:c,buttonAvailable:t,setButtonState:a}))},null),document.querySelector(".basket__stages"))}]);