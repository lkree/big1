!function(e){var t={};function a(r){if(t[r])return t[r].exports;var l=t[r]={i:r,l:!1,exports:{}};return e[r].call(l.exports,l,l.exports,a),l.l=!0,l.exports}a.m=e,a.c=t,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)a.d(r,l,function(t){return e[t]}.bind(null,l));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=2)}([function(e,t){e.exports=React},function(e,t){e.exports=ReactDOM},function(e,t,a){"use strict";a.r(t);var r=a(0),l=a.n(r);const n=({text:e,className:t})=>l.a.createElement("li",{className:t},e);function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const c=({header:e})=>{const t=["Корзина","Способ доставки","Подтверждение заказа"];return l.a.createElement("ul",{className:"basket__progress-header",style:{display:"flex","list-style-type":"none"}},(e=>t.map((t,a)=>{const r={text:window.innerWidth>450?t:a+1,className:e===t?"basket__progress-header-item basket__progress-header-item--active":"basket__progress-header-item"};return l.a.createElement(n,s({key:a},r))}))(e))},i=({className:e})=>(Object(r.useEffect)(()=>window.deliveryPickup()),l.a.createElement("div",{className:`delivery-pickup ${e}`,"data-delivery-type":"Самовывоз"},l.a.createElement("input",{type:"text",className:"delivery-pickup__input",placeholder:"Введите город"}),l.a.createElement("div",{className:"delivery-pickup__points-list"}))),o=({showPoint:e,deliveryProps:t,onPickAnotherPointClick:a,buttonAvailable:r,setButtonState:n,step:s})=>{const{header:c,linkText:i,showModule:o}=t,m=getCookie("deliveryAddress");return l.a.createElement(l.a.Fragment,null,l.a.createElement("header",{className:"basket__react-delivery-choose-header"},c),(e=>e&&!o?l.a.createElement("div",{className:"basket__react-delivery-choose-point"},m):"")(e),l.a.createElement("button",{onClick:()=>{a({...t,showModule:!o});(()=>{const e=[getCookie("deliveryAddress"),getCookie("deliveryDeadline"),getCookie("deliveryCost"),getCookie("deliveryType")].every(e=>!!e);n({available:e})})()},className:"basket__react-delivery-choose-pickAnotherPoint"},i))},m=()=>{const[e,t]=Object(r.useState)({header:"",name:"",phone:"",schedule:"",mapLink:""});Object(r.useEffect)(()=>{const e=getCookie("deliveryType");try{"pickup"===e?(()=>{const e=getCookie("deliveryCity"),a=getCookie("deliveryAddress"),r=window.citiesList.filter(({name:t})=>t===e)[0],{mapLink:l=""}=r,n={...r.branches.filter(({name:e})=>e===a)[0]};t({...n,header:"Контактная информация",mapLink:l})})():((e,a)=>{const r=new ShiptorPointsGetter({usersCity:e,fromCity:"_"});r.getUsersCityKladr().then(()=>{r.getDeliveryPoints().then(({result:e})=>{const r=e.filter(e=>e.id===a);try{const[{address:e,phones:a=[],work_schedule:l}]=r;t({header:"Контактная информация",name:e,phone:a[0]?a.reduce((e,t)=>`${e} + /n + ${t}`):"",schedule:l,mapLink:""})}catch({message:e}){console.log(e)}})})})(getCookie("deliveryCity"),+getCookie("selfExportPointId"))}catch({message:e}){console.log(e)}},[]);const{header:a,name:n,phone:s,schedule:c,mapLink:i}=e;return l.a.createElement("section",{className:"basket__react-additional-info"},l.a.createElement("header",{className:"basket__react-additional-info__header"},a),l.a.createElement("div",{className:"basket__react-additional-info__body"},l.a.createElement("div",{className:"basket__react-additional-info__left-part"},l.a.createElement("div",{className:"basket__react-additional-info__name"},n),l.a.createElement("div",{className:"basket__react-additional-info__phone"},s),l.a.createElement("div",{className:"basket__react-additional-info__schedule"},c)),l.a.createElement("div",{className:"basket__react-additional-info-right-part"},i?l.a.createElement("iframe",{src:i,width:"100%",height:"360",frameBorder:"0"}):"")))};function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const p=({deliveryType:e,...t})=>{const{deliveryProps:{showModule:a}}=t,r=e===getCookie("deliveryType");return l.a.createElement(l.a.Fragment,null,l.a.createElement(o,d({showPoint:r},t)),a?l.a.createElement(i,t):r?l.a.createElement(m,null):"")},u=({className:e})=>(Object(r.useEffect)(()=>window.deliverySelfExport()),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:`delivery-selfExport ${e}`,"data-delivery-type":"Пункт выдачи"},l.a.createElement("div",{className:"delivery-selfExport__wait-screen hidden preloader-mini"},l.a.createElement("div",{className:"preloader-mini__item"},l.a.createElement("div",{className:"preloader-mini__item-tool"}),l.a.createElement("div",{className:"preloader-mini__item-tool"}),l.a.createElement("div",{className:"preloader-mini__item-tool"}),l.a.createElement("div",{className:"preloader-mini__item-tool"}))),l.a.createElement("div",{className:"delivery-selfExport__chosen-city-wrapper"},l.a.createElement("p",{className:"delivery-selfExport__chosen-city-descr"},"Текущий город: "),l.a.createElement("p",{className:"delivery-selfExport__chosen-city"}),l.a.createElement("button",{className:"delivery-selfExport__change-city"},"Выбрать другой город")),l.a.createElement("section",{className:"delivery-selfExport__pickup"},l.a.createElement("header",{className:"delivery-selfExport__pickup-header"},l.a.createElement("p",{className:"delivery-selfExport__pickup-header-text"},"Пункты выдачи"),l.a.createElement("button",{className:"delivery-selfExport__show-map"},"Посмотреть на карте")),l.a.createElement("input",{type:"text",className:"delivery-selfExport__pickup-search-input",placeholder:"Поиск пункта выдачи"}),l.a.createElement("ul",{className:"delivery-selfExport__pickup-list"})),l.a.createElement("section",{className:"delivery-selfExport__cities hidden"},l.a.createElement("input",{type:"text",className:"delivery-selfExport__city-search-input",placeholder:"Поиск города"}),l.a.createElement("ul",{className:"delivery-selfExport__cities-list"})),l.a.createElement("section",{className:"delivery-selfExport__error hidden"},l.a.createElement("p",{className:"delivery-selfExport__error-text"},"К сожалению пункты выдачи не найдены :(",l.a.createElement("br",null),"Попробуйте сменить город")))));function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const E=({deliveryType:e,...t})=>{const{deliveryProps:{showModule:a}}=t,r=e===getCookie("deliveryType");return l.a.createElement(l.a.Fragment,null,l.a.createElement(o,_({showPoint:r},t)),a?l.a.createElement(u,t):r?l.a.createElement(m,null):"")},v=({onTabClick:e,deliveryType:t,...a})=>{const n={pickup:{header:"Офисы обслуживания",point:getCookie("deliveryAddress"),linkText:"Выбрать другое место самовывоза",showModule:!1},selfExport:{header:"Офисы самовывоза",point:getCookie("deliveryAddress"),linkText:"Выбрать другой пункт выдачи",showModule:!1}},[s,c]=Object(r.useState)(n[t]),i="pickup"===t,o={deliveryProps:s,onPickAnotherPointClick:c,deliveryType:t,...a},m=t=>{e(t),c(n[t])},d=`basket__progress-header-item .basket__progress-header-item--without-before' ${i?"basket__progress-header-item--active":""}`,u=`basket__progress-header-item .basket__progress-header-item--without-before' ${i?"":"basket__progress-header-item--active"}`;return l.a.createElement(l.a.Fragment,null,l.a.createElement("ul",null,l.a.createElement("li",{className:d,onClick:()=>m("pickup")},"Самовывоз"),l.a.createElement("li",{className:u,onClick:()=>m("selfExport")},"Доставка")),i?l.a.createElement(p,o):l.a.createElement(E,o))},y=({header:e})=>l.a.createElement("header",{className:"basket__react-stage-header"},e),b=({header:e,...t})=>l.a.createElement(l.a.Fragment,null,l.a.createElement(c,{header:e}),l.a.createElement(y,{header:e}),l.a.createElement("main",null,l.a.createElement(v,t))),k=()=>l.a.createElement("header",{className:"basket__react-final-header"},"Final Header"),f=({name:e,date:t,count:a,price:r,link:n})=>l.a.createElement("li",{className:"basket__react-final-goods-item"},l.a.createElement("a",{href:n},l.a.createElement("p",null,e)),l.a.createElement("p",null,t),l.a.createElement("p",null,a," шт."),l.a.createElement("p",null,r*a," р.")),h=()=>{return l.a.createElement("ul",{className:"basket__react-final-goods-item-list"},window.basketApi.getBasketItems().map(e=>l.a.createElement(f,e)))},g=()=>{const e=window.basketApi.getPositionsNumber(),t=window.basketApi.getTotalSum();return l.a.createElement("header",{className:"basket__react-final-goods-header"},l.a.createElement("p",null,(e=>{switch(!0){case"1"===e.toString().slice(-1):return`${e} позиция`;case+e.toString().slice(-1)>1&&+e.toString().slice(-1)<5:return`${e} позиции`;default:return`${e} позиций`}})(e)),l.a.createElement("p",null,"К оплате ",t," р."))},N=()=>l.a.createElement("div",{className:"basket__react-final-goods"},l.a.createElement(g,null),l.a.createElement(h,null)),x=()=>{return l.a.createElement("header",{className:"basket__react-final-delivery-header"},l.a.createElement("p",null,"pickup"===getCookie("deliveryType")?"Самовывоз":"Пункт выдачи"),l.a.createElement("p",null,`${getCookie("deliveryCost")||0} р.`))},w=()=>{return l.a.createElement("div",{className:"basket__react-final-delivery-body"},l.a.createElement("p",null,"Адрес:"),l.a.createElement("p",null,getCookie("deliveryAddress")||""))},C=()=>l.a.createElement("div",{className:"basket__react-final-delivery"},l.a.createElement(x,null),l.a.createElement(w,null)),O=()=>{const e=window.basketApi.getMaxDeliveryDate();return l.a.createElement("div",{className:"basket__react-final-delivery-deadline"},l.a.createElement("p",null,"Срок доставки"),l.a.createElement("p",null,e," дн."))},P=()=>l.a.createElement("div",{className:"basket__react-final-body"},l.a.createElement(N,null),l.a.createElement(C,null),l.a.createElement(O,null)),T=()=>l.a.createElement("main",null,l.a.createElement(k,null),l.a.createElement(P,null)),j=({header:e})=>l.a.createElement(l.a.Fragment,null,l.a.createElement(c,{header:e}),l.a.createElement(y,{header:e}),l.a.createElement(T,null));function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}const A=({text:e,available:t,...a})=>l.a.createElement("button",S({},a,{disabled:!t}),l.a.createElement("span",{className:"basket__react-bottom-nav-btn-text"},e),l.a.createElement("span",{className:"basket__react-bottom-nav-btn-arrow"})),M=({step:e,onClick:t,buttonAvailable:a,setButtonState:n})=>{Object(r.useEffect)(()=>{const e=[getCookie("deliveryAddress"),getCookie("deliveryDeadline"),getCookie("deliveryCost"),getCookie("deliveryType")].every(e=>!!e);n({available:e})},[]);return l.a.createElement("div",{className:"basket__react-bottom-nav"},(()=>{const r={2:{text:["Back To Basket","Next"],className:"basket__react-bottom-nav-btn",onClick:[window.basketApi.returnToBasket,t.bind(null,"add")],available:[!0,a.available]},3:{text:["Prev","Оформить"],className:"basket__react-bottom-nav-btn",onClick:[t.bind(null,"sub"),e=>e.preventDefault()],available:[!0,a.available]}};return new Array(2).fill("").map((t,a)=>{const{text:n,className:s,onClick:c,available:i}=r[e];return l.a.createElement(A,{key:a,text:n[a],className:s,onClick:c[a],available:i[a]})})})())},$=({deliveryType:e})=>{return l.a.createElement("div",{className:"basket__react-bottom-info"},(()=>{const t=window.basketApi.getTotalPricesAndItems();return[{text:t.split(":")[0],value:t.split(":")[1],className:"basket__react-bottom-info-item basket__react-bottom-info-item--products"},{text:"Стоимость доставки",value:`${"pickup"===e?0:350} р`,className:"basket__react-bottom-info-item basket__react-bottom-info-item--delivery"}].map(({text:e,value:t,className:a},r)=>l.a.createElement("div",{key:r,className:a},e,": ",l.a.createElement("span",{className:"basket__react-bottom-info-item-mark"},t)))})())},B=()=>l.a.createElement("div",{className:"basket__react-bottom-message"},l.a.createElement("p",{className:"basket__react-bottom-message-text"},"Обращаем Ваше внимание, что окончательная стоимость и состав заказа, если в нём присутствуют товары и/или услуги, участвующие в акции, будут подтверждены после обработки заказа.")),F=({deliveryType:e,...t})=>l.a.createElement(l.a.Fragment,null,l.a.createElement("section",{className:"basket__react-bottom-panel"},l.a.createElement($,{deliveryType:e}),l.a.createElement(M,t)),l.a.createElement(B,null));var D=a(1);a.n(D).a.render(l.a.createElement(()=>{const e={2:"Способ доставки",3:"Подтверждение заказа"},[t,a]=Object(r.useState)({available:!1}),[n,s]=Object(r.useState)(getCookie("deliveryType")||"pickup"),[c,i]=Object(r.useState)(2),o=2===c?l.a.createElement(b,{header:e[c],onTabClick:e=>s(e),deliveryType:n,setButtonState:a}):l.a.createElement(j,{setButtonState:a,header:e[c]});return l.a.createElement(l.a.Fragment,null,o,l.a.createElement(F,{onClick:e=>i(t=>((e,t)=>{const a="add"===e?t+1:t-1;return a<4&&a>1?a:t})(e,t)),step:c,deliveryType:n,buttonAvailable:t,setButtonState:a}))},null),document.querySelector(".basket__stages"))}]);