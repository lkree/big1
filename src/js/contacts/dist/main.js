!function(e){var t={};function a(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,a),s.l=!0,s.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=2)}([function(e,t){e.exports=React},function(e,t){e.exports=ReactDOM},function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(1);const c=({branches:e,mapLink:t,kladr_id:a,name:n,onClick:i})=>{const c=e?"contacts__city-button contacts__city-button--branch":"contacts__city-button";return s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{className:c,onClick:s=>i(((n,s)=>e?{branches:e,mapLink:t,city:s}:{evt:n,kladr_id:a})(s,n))},n))};function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const o=({kladr_id:e,firstLetter:t,renderBranch:a,onClick:n,branches:i,...o})=>s.a.createElement("li",{key:e,className:"contacts__item"},t&&s.a.createElement("div",{className:"contacts__item-first-letter"},t),i?s.a.createElement(c,r({},o,{kladr_id:e,branches:i,onClick:a})):s.a.createElement(c,r({},o,{kladr_id:e,branches:i,onClick:n})));function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const h=({street:e,schedule:t,photos:a,name:n,onClick:i,city:c,...r})=>{const o=e=>{e.preventDefault(),$(".fancybox").fancybox({openEffect:"none",closeEffect:"none"})};return s.a.createElement("li",{className:"contacts__branch"},s.a.createElement("header",{className:"contacts__branch-header",onClick:e=>{const{target:t}=e,a=$(t).next();let n;e.target.classList.contains("contacts__branch-header--open")&&(n=!0),$(".contacts__branch-body-wrapper").each((function(){$(this).prev().removeClass("contacts__branch-header--open"),$(this).parent().removeClass("contacts__branch--open"),$(this).slideUp()})),n||(o(e),a.slideDown(),t.classList.add("contacts__branch-header--open"),t.parentElement.classList.add("contacts__branch--open"))}},n),s.a.createElement("div",{className:"contacts__branch-body-wrapper"},s.a.createElement("div",{className:"contacts__branch-body"},s.a.createElement("div",{className:"contacts__branch-info"},s.a.createElement("div",{className:"contacts__branch-street"},e),s.a.createElement("div",{className:"contacts__branch-schedule"},t),s.a.createElement("button",l({onClick:i,className:"contacts__branch-accept",value:n,"data-city":c},r),"Выбрать")),s.a.createElement("div",{className:"contacts__branch-photos"},(e=>e.map(e=>s.a.createElement("a",{className:"fancybox contacts__branch-photo-wrapper",rel:"gallery1",href:e},s.a.createElement("img",{src:e,className:"contacts__branch-photo"}))))(a)))))},d=({branches:e,onClick:t,mapLink:a,onBranchClick:n,city:i})=>{return s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{onClick:t,className:"contacts__back-button"},"Назад"),s.a.createElement("header",{className:"contacts__branches-wrapper-header"},"Офисы обслуживания BIG1.RU"),s.a.createElement("ul",{className:"contacts__branches-wrapper"},(e=>e.map(({name:e,street:t,schedule:a,photos:c,id:r})=>{const o={name:e,street:t,schedule:a,photos:c,key:e,onClick:n,id:r,city:i};return s.a.createElement(h,o)}))(e)),s.a.createElement("iframe",{src:a,width:"100%",height:"360",frameBorder:"0"}))},m=({currentCity:e})=>s.a.createElement("header",{className:"contacts__current-region"},s.a.createElement("span",{className:"contacts__current-region-title"},"Ваш город: "),s.a.createElement("span",{className:"contacts__current-region-city"},e)),p=({onCityFilter:e})=>s.a.createElement("div",{className:"contacts__search-city-wrapper"},s.a.createElement("input",{type:"text",onInput:e,className:"contacts__search-input",placeholder:"Поиск"}),s.a.createElement("div",{className:"contacts__search-city-help"},s.a.createElement("span",{className:"contacts__search-city-icon"}),"— в городе есть офис обслуживания BIG1.RU")),u=({renderCity:e})=>s.a.createElement("ul",{className:"contacts__city-list"},e());function y(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class v extends s.a.Component{constructor(e){super(e),y(this,"getYmapsCity",()=>{let e;try{e=YMaps.location.city}catch(e){}return e}),y(this,"renderCity",()=>this.state.filteredList.map(({name:e,branches:t,kladr_id:a,firstLetter:n,mapLink:i})=>{const c={name:e,branches:t,kladr_id:a,firstLetter:n,renderBranch:this.renderBranch,onClick:this.onNonBranchClick,mapLink:i};return s.a.createElement(o,c)})),y(this,"renderBranch",({branches:e,mapLink:t,city:a})=>{this.scrollToTop(),this.setState({isRenderedBrunch:!this.state.isRenderedBrunch,branches:e,mapLink:t,filteredList:this.citiesList,city:a})}),y(this,"saveCookie",(e,t)=>{const a={path:"/",secure:!0,"max-age":new Date(Date.now()+864e7)};let n=encodeURIComponent(e)+"="+encodeURIComponent(t);for(const e in a){n+="; "+e;const t=a[e];!0!==t&&(n+="="+t)}document.cookie=n}),y(this,"getCookie",e=>{const t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}),y(this,"saveActiveElement",e=>this.setState({activeElement:e})),y(this,"removeActiveElement",()=>this.saveActiveElement("")),y(this,"setActiveElement",e=>{this.saveActiveElement(e),e.classList.add("contacts__city-button--active")}),y(this,"disableActiveElement",()=>{var e;null===(e=this.state.activeElement.classList)||void 0===e||e.remove("contacts__city-button--active"),this.removeActiveElement()}),y(this,"onNonBranchClick",({evt:{target:e,target:{textContent:t}},kladr_id:a})=>{let n=!1;const s=()=>(s.checkStatement=(e,t,a)=>(e?t():a(),s),s.setMapKladr=()=>(window.JCShiptorWidgetPvz.setParams({location:{kladr_id:a}}),s),s.refreshMap=()=>(!n&&window.JCShiptorWidgetPvz.refresh(),s),s.callMap=()=>(!n&&this.map.click(),s),s.removeActiveElement=()=>(this.disableActiveElement(),s),s.setActiveElement=()=>(this.setActiveElement(e),s),s.saveCity=()=>{const e=()=>(e.saveCityId=()=>(this.setCityId(),e),e.saveCityCookie=()=>(this.saveCookie("deliveryCity",t),e),e);return e().saveCityId().saveCityCookie(),s},s.chooseCity=()=>(this.chooseCity(t),s),s.refreshHeader=()=>(window.userCityHandler({cityName:t,cityId:this.baseCityId}),s),s.saveDeliveryType=()=>(this.saveDeliveryType("selfExport"),s),s.removePickupFlag=()=>(n&&sessionStorage.removeItem("fromPickup"),s),s.setPickup=()=>(n=!0,s),s.emptyFunction=()=>s,s.savePickupData=()=>(n&&this.onBranchClick({target:{value:"",dataset:{city:t},id:28}}),s),s);s().checkStatement(!!sessionStorage.getItem("fromPickup"),s.setPickup,s.emptyFunction).setMapKladr().refreshMap().callMap().removeActiveElement().setActiveElement().saveCity().removePickupFlag().saveDeliveryType().chooseCity().refreshHeader().savePickupData()}),y(this,"chooseCity",e=>this.setState({chosenCity:e})),y(this,"filterCityList",({target:e})=>{if(e.value.length<3)return this.setState({filteredList:this.citiesList});const{citiesList:t}=this;return this.setState({filteredList:t.filter(t=>{const a=t.name.toLowerCase();let n=e.value.toLowerCase();return n=n.replace("/ё/g","e"),~a.indexOf(n)})})}),y(this,"scrollToTop",()=>{$("html,body").animate({scrollTop:0},500)}),y(this,"onBranchClick",({target:{value:e,dataset:{city:t},id:a}})=>{this.setCityId(a),this.saveCookie("deliveryAddress",e),this.saveCookie("deliveryCost","0"),this.saveCookie("deliveryDeadline","0"),this.saveCookie("deliveryCity",t),this.saveDeliveryType("pickup"),sessionStorage.removeItem("fromPickup"),this.renderBranch([]),this.chooseCity(t),this.disableActiveElement(),this.getBackToBasket()||location.reload()}),y(this,"setCityId",(e=this.baseCityId)=>this.saveCookie("region_id",e)),y(this,"setSelfExportPointId",e=>this.saveCookie("selfExportPointId",e)),y(this,"saveDeliveryType",e=>this.saveCookie("deliveryType",e)),y(this,"getBackToBasket",()=>!!sessionStorage.getItem("fromBasket")&&(sessionStorage.removeItem("fromBasket"),location.assign("/baskets"),!0)),y(this,"PickupPointClickHandler",()=>{document.querySelector("#shiptor_widget_pvz").addEventListener("onPvzSelect",({detail:{address:e,id:t,shipping_days:a,courier:n}})=>{(()=>{const e=parseInt(a);if(e)this.saveCookie("deliveryDeadline",e.toString());else{const e=document.querySelector(".contacts__city-button--active").textContent,t=new ShiptorPointsGetter({usersCity:e,fromCity:"_"}),a=({result:{methods:e}})=>{let t,a;try{t=e[0].min_days}catch({message:e}){console.log(e),t=0}try{a=e[0].max_days}catch({message:e}){console.log(e),a=0}return[t,a]};t.getUsersCityKladr().then(()=>{t.calculateShipping().then(e=>{const[t,n]=a(e);this.saveCookie("deliveryDeadline",n.toString()||t.toString()||"0")})})}})(),this.saveCookie("deliveryAddress",e),this.saveCookie("deliveryCost",window.citiesList[0].price),this.saveCookie("deliveryCourier",n),this.setSelfExportPointId(t),this.getBackToBasket()})}),this.baseCityId="28",this.citiesList=window.citiesList,this.map=document.querySelector(".contactMap__call-map"),this.state={isRenderedBranch:!1,branches:"",chosenCity:this.getCookie("deliveryCity")||this.getYmapsCity()||"",filteredList:this.citiesList,activeElement:"",city:""}}componentDidMount(){this.PickupPointClickHandler()}render(){const{isRenderedBrunch:e,branches:t,chosenCity:a,mapLink:n,city:i}=this.state,{filterCityList:c,onBranchClick:r,renderCity:o}=this;return s.a.createElement("div",{className:"contacts"},s.a.createElement(m,{currentCity:a}),e?s.a.createElement(d,{branches:t,onClick:this.renderBranch,onBranchClick:r,mapLink:n,city:i}):s.a.createElement(s.a.Fragment,null,s.a.createElement(p,{onCityFilter:c}),s.a.createElement(u,{renderCity:o})))}}a.n(i).a.render(s.a.createElement(()=>s.a.createElement(v,null),null),document.querySelector("#root"))}]);