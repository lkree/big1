!function(e){var t={};function a(n){if(t[n])return t[n].exports;var c=t[n]={i:n,l:!1,exports:{}};return e[n].call(c.exports,c,c.exports,a),c.l=!0,c.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)a.d(n,c,function(t){return e[t]}.bind(null,c));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=2)}([function(e,t){e.exports=React},function(e,t){e.exports=ReactDOM},function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),i=a(1);const r=({branches:e,mapLink:t,kladr_id:a,name:n,onClick:i})=>{const r=e?"contacts__city-button contacts__city-button--branch":"contacts__city-button";return c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{className:r,onClick:c=>i(((n,c)=>e?{branches:e,mapLink:t,city:c}:{evt:n,kladr_id:a})(c,n))},n))};function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const o=({kladr_id:e,firstLetter:t,renderBranch:a,onClick:n,branches:i,...o})=>c.a.createElement("li",{key:e,className:"contacts__item"},t?c.a.createElement("div",{className:"contacts__item-first-letter"},t):void 0,i?c.a.createElement(r,s({},o,{kladr_id:e,branches:i,onClick:a})):c.a.createElement(r,s({},o,{kladr_id:e,branches:i,onClick:n})));function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const h=({street:e,schedule:t,photos:a,name:n,onClick:i,city:r,...s})=>{const o=e=>{e.preventDefault(),$(".fancybox").fancybox({openEffect:"none",closeEffect:"none"})};return c.a.createElement("li",{className:"contacts__branch"},c.a.createElement("header",{className:"contacts__branch-header",onClick:e=>{const{target:t}=e,a=$(t).next();let n;e.target.classList.contains("contacts__branch-header--open")&&(n=!0),$(".contacts__branch-body-wrapper").each((function(){$(this).prev().removeClass("contacts__branch-header--open"),$(this).parent().removeClass("contacts__branch--open"),$(this).slideUp()})),n||(o(e),a.slideDown(),t.classList.add("contacts__branch-header--open"),t.parentElement.classList.add("contacts__branch--open"))}},n),c.a.createElement("div",{className:"contacts__branch-body-wrapper"},c.a.createElement("div",{className:"contacts__branch-body"},c.a.createElement("div",{className:"contacts__branch-info"},c.a.createElement("div",{className:"contacts__branch-street"},e),c.a.createElement("div",{className:"contacts__branch-schedule"},t),c.a.createElement("button",l({onClick:i,className:"contacts__branch-accept",value:n,"data-city":r},s),"Выбрать")),c.a.createElement("div",{className:"contacts__branch-photos"},(e=>e.map(e=>c.a.createElement("a",{className:"fancybox contacts__branch-photo-wrapper",rel:"gallery1",href:e},c.a.createElement("img",{src:e,className:"contacts__branch-photo"}))))(a)))))},d=({branches:e,onClick:t,mapLink:a,onBranchClick:n,city:i})=>{return c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{onClick:t,className:"contacts__back-button"},"Назад"),c.a.createElement("header",{className:"contacts__branches-wrapper-header"},"Офисы обслуживания BIG1.RU"),c.a.createElement("ul",{className:"contacts__branches-wrapper"},(e=>e.map(({name:e,street:t,schedule:a,photos:r,id:s})=>{const o={name:e,street:t,schedule:a,photos:r,key:e,onClick:n,id:s,city:i};return c.a.createElement(h,o)}))(e)),c.a.createElement("iframe",{src:a,width:"100%",height:"360",frameBorder:"0"}))},m=({currentCity:e})=>c.a.createElement("header",{className:"contacts__current-region"},c.a.createElement("span",{className:"contacts__current-region-title"},"Ваш город: "),c.a.createElement("span",{className:"contacts__current-region-city"},e)),p=({onCityFilter:e})=>c.a.createElement("div",{className:"contacts__search-city-wrapper"},c.a.createElement("input",{type:"text",onInput:e,className:"contacts__search-input",placeholder:"Поиск"}),c.a.createElement("div",{className:"contacts__search-city-help"},c.a.createElement("span",{className:"contacts__search-city-icon"}),"— в городе есть офис обслуживания BIG1.RU")),u=({renderCity:e})=>c.a.createElement("ul",{className:"contacts__city-list"},e());function y(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class v extends c.a.Component{constructor(e){var t,a;super(e),y(this,"renderCity",()=>this.state.filteredList.map(({name:e,branches:t,kladr_id:a,firstLetter:n,mapLink:i})=>{const r={name:e,branches:t,kladr_id:a,firstLetter:n,renderBranch:this.renderBranch,onClick:this.onNonBranchClick,mapLink:i};return c.a.createElement(o,r)})),y(this,"renderBranch",({branches:e,mapLink:t,city:a})=>{this.scrollToTop(),this.setState({isRenderedBrunch:!this.state.isRenderedBrunch,branches:e,mapLink:t,filteredList:this.citiesList,city:a})}),y(this,"saveCookie",(e,t)=>{const a={path:"/",secure:!0,"max-age":new Date(Date.now()+864e7)};let n=encodeURIComponent(e)+"="+encodeURIComponent(t);for(const e in a){n+="; "+e;const t=a[e];!0!==t&&(n+="="+t)}document.cookie=n}),y(this,"getCookie",e=>{const t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}),y(this,"saveActiveElement",e=>this.setState({activeElement:e})),y(this,"removeActiveElement",()=>this.saveActiveElement("")),y(this,"setActiveElement",e=>{this.saveActiveElement(e),e.classList.add("contacts__city-button--active")}),y(this,"disableActiveElement",()=>{var e;null===(e=this.state.activeElement.classList)||void 0===e||e.remove("contacts__city-button--active"),this.removeActiveElement()}),y(this,"onNonBranchClick",({evt:{target:e,target:{textContent:t}},kladr_id:a})=>{const n=()=>(n.setMapKladr=()=>(window.JCShiptorWidgetPvz.setParams({location:{kladr_id:a}}),n),n.refreshMap=()=>(window.JCShiptorWidgetPvz.refresh(),n),n.callMap=()=>(this.map.click(),n),n.removeActiveElement=()=>(this.disableActiveElement(),n),n.setActiveElement=()=>(this.setActiveElement(e),n),n.saveCity=()=>{const e=()=>(e.saveCityId=()=>(this.setCityId(),e),e.saveCityCookie=()=>(this.saveCookie("deliveryCity",t),e),e);return e().saveCityId().saveCityCookie(),n},n.chooseCity=()=>(this.chooseCity(t),n),n.refreshHeader=()=>(window.userCityHandler({cityName:t,cityId:this.baseCityId}),n),n.saveDeliveryType=()=>(this.saveDeliveryType("selfExport"),n),n);n().setMapKladr().refreshMap().callMap().removeActiveElement().setActiveElement().saveCity().saveDeliveryType().chooseCity().refreshHeader()}),y(this,"chooseCity",e=>this.setState({chosenCity:e})),y(this,"filterCityList",({target:e})=>{if(e.value.length<3)return this.setState({filteredList:this.citiesList});const{citiesList:t}=this;return this.setState({filteredList:t.filter(t=>{const a=t.name.toLowerCase();let n=e.value.toLowerCase();return n=n.replace("/ё/g","e"),~a.indexOf(n)})})}),y(this,"scrollToTop",()=>{$("html,body").animate({scrollTop:0},500)}),y(this,"onBranchClick",({target:e,target:{value:t,dataset:{city:a}},id:n})=>{this.setCityId(n),this.saveCookie("deliveryAddress",t),this.saveCookie("deliveryCity",a),this.saveDeliveryType("pickup"),this.renderBranch([]),this.chooseCity(a),this.disableActiveElement(),location.reload()}),y(this,"setCityId",(e=this.baseCityId)=>this.saveCookie("region_id",e)),y(this,"setSelfExportPointId",e=>this.saveCookie("selfExportPointId",e)),y(this,"saveDeliveryType",e=>this.saveCookie("deliveryType",e)),y(this,"PickupPointClickHandler",()=>{document.querySelector("#shiptor_widget_pvz").addEventListener("onPvzSelect",({detail:{address:e,id:t,shipping_days:a}})=>{(()=>{const e=parseInt(a);if(e)this.saveCookie("deliveryDeadline",e.toString());else{const e=document.querySelector(".contacts__city-button--active").textContent,t=new ShiptorPointsGetter({usersCity:e,fromCity:"_"}),a=({result:{methods:e}})=>{let t,a;try{t=e[0].min_days}catch({message:e}){console.log(e),t=0}try{a=e[0].max_days}catch({message:e}){console.log(e),a=0}return[t,a]};t.getUsersCityKladr().then(()=>{t.calculateShipping().then(e=>{const[t,n]=a(e);this.saveCookie("deliveryDeadline",n.toString()||t.toString()||"0")})})}})(),this.saveCookie("deliveryAddress",e),this.saveCookie("deliveryCost",window.citiesList[0].price),this.setSelfExportPointId(t)})}),this.baseCityId="28",this.citiesList=window.citiesList,this.map=document.querySelector(".contactMap__call-map"),this.state={isRenderedBranch:!1,branches:"",chosenCity:this.getCookie("deliveryCity")||(null===(t=YMaps)||void 0===t?void 0:null===(a=t.location)||void 0===a?void 0:a.city)||"",filteredList:this.citiesList,activeElement:"",city:""}}componentDidMount(){this.PickupPointClickHandler()}render(){const{isRenderedBrunch:e,branches:t,chosenCity:a,mapLink:n,city:i}=this.state,{filterCityList:r,onBranchClick:s,renderCity:o}=this;return c.a.createElement("div",{className:"contacts"},c.a.createElement(m,{currentCity:a}),e?c.a.createElement(d,{branches:t,onClick:this.renderBranch,onBranchClick:s,mapLink:n,city:i}):c.a.createElement(c.a.Fragment,null,c.a.createElement(p,{onCityFilter:r}),c.a.createElement(u,{renderCity:o})))}}a.n(i).a.render(c.a.createElement(()=>c.a.createElement(v,null),null),document.querySelector("#root"))}]);